{"version":3,"sources":["backend_processing/annotation-processing.js","static_data/behaviors.js","static_data/posture.js","ui_elements/Components/change_table.js","backend_processing/bounding_box.js","backend_processing/frame_bounding_box.js","backend_processing/key_point.js","backend_processing/segmentation.js","ui_elements/Pages/main_upload.js","ui_elements/Pages/main_youtube.js","serviceWorker.js","index.js"],"names":["AnnotationProcessing","annotation_json","this","objects","console","log","id","frame_num","i","objects_frame","length","curr_obj","curr_obj_frames","j","push","behaviors","value","label","posture","Type","SELECT","ChangeTable","fabric","require","BoundingBox","top","left","width","height","color","behavior","Rect","hasRotatingPoint","uniScaleTransform","fill","borderColor","opacity","Text","toString","fontSize","canvas","group","Group","addWithUpdate","rectangle","id_text","toObject","temp","propertiesToInclude","util","object","extend","call","local_id","add","FrameBoundingBox","frame_data","canvas_width","canvas_height","video_height","vide_width","windowWidth","windowHeight","bounding_boxes","Math","random","curr_box","getTop","getLeft","getWidth","getHeight","generate_no_behavior","data","floor","KeyPoint","makeCircle","line1","line2","line3","line4","c","Circle","strokeWidth","radius","stroke","hasControls","hasBorders","makeLine","coords","Line","selectable","evented","Object","prototype","originX","originY","line","line5","line6","get","on","e","p","target","set","renderAll","$","Segmentation","activeLine","polygonMode","pointArray","Array","lineArray","activeShape","prototypefabric","selection","options","polygon","generatePolygon","addPoint","class","pointer","getPointer","x2","x","y2","y","points","drawPolygon","Date","getTime","circle","layerX","getZoom","layerY","objectCaching","pos","Polygon","remove","polyPoint","each","index","point","columns","dataField","text","editor","type","createReactClass","skip_value","fabricCanvas","Canvas","Fabric","componentDidMount","el","ReactDOM","findDOMNode","initialize","backgroundColor","render","annotation_data","upload","disable_buttons","toast_text","MainUpload","useState","annotationType","setAnnotationType","boxCount","setBoxCount","addToCanvas","currentFrame","is_hidden","new_bbox","setActiveObject","generate_stick","generate_polygon","fire","getActiveObject","toJSON","splice","videoFilePath","setVideoFileURL","oldAnnotation","setOldAnnotation","useEffect","getAllObjectByFrame","downloadOldAnnotation","file","Promise","resolve","reject","reader","FileReader","onload","JSON","parse","result","readAsText","files","playing","setPlaying","handlePlaying","event","play_button_text","setSeeking","sliderPercent","setSliderPercent","player","setPlayer","duration","setDuration","setCurrentFrame","skip_frame_forward","total_frames","seekTo","getCurrentTime","skip_frame_backward","downloadFile","a","fileName","json","stringify","blob","Blob","URL","createObjectURL","href","link","document","createElement","download","body","appendChild","click","removeChild","show","setShow","handleClose","handleSquareBox","handleKeyPoint","handleSegmentation","save","changeSave","onKeyPress","key","addEventListener","removeEventListener","clear","loadFromJSON","Navbar","bg","variant","className","Brand","Nav","Link","onClick","NavDropdown","disabled","title","Item","Divider","defaultValue","onChange","Form","style","float","File","custom","then","accept","Button","parseInt","position","Toast","onClose","delay","autohide","Header","Modal","onHide","closeButton","Title","Body","Footer","display","gridColumn","gridRow","onProgress","val","round","bbox","generate_frame","ref","onDuration","url","controls","volume","muted","pip","min","max","step","onMouseDown","parseFloat","onMouseUp","keyField","cellEdit","cellEditFactory","mode","blurToSave","afterSaveCell","oldValue","newValue","row","column","global_currFrame","Boolean","window","location","hostname","match","StrictMode","getElementById","navigator","serviceWorker","ready","registration","unregister","catch","error","message"],"mappings":"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","file":"static/js/main.a10d8db5.chunk.js","sourcesContent":["export default class AnnotationProcessing {\n    constructor(annotation_json){\n        this.objects = annotation_json['objects']\n        console.log(this.objects)\n    }\n\n    getObjects() {\n        return this.objects\n    }\n\n    getObjectById(id) {\n        return this.objects[id]\n    }\n\n    getObjectByIdFrame(id, frame_num){\n        return this.objects[id][frame_num]\n    }\n\n    getAllObjectByFrame(frame_num){\n        var i;\n        var objects_frame = []\n        for (i = 0; i < this.objects.length; i++){\n            var curr_obj = this.objects[i]\n            if(curr_obj['frames'][curr_obj['frames'].length-1]['frameNumber'] < frame_num){\n                continue;\n            }\n            var curr_obj_frames = curr_obj['frames'];\n            for (var j = 0; j < curr_obj_frames.length; j++){\n                if(curr_obj_frames[j]['frameNumber'] === frame_num){\n                    objects_frame.push(curr_obj_frames[j]);\n                    break;\n                }\n            }\n        }\n        console.log(objects_frame)\n        return objects_frame;\n    }\n\n}\n\n","const behaviors = [{\n  value: 'inactive',\n  label: 'Inactive'\n},{\n  value: 'walking',\n  label: 'Walking'\n},{\n  value: 'running',\n  label: 'Running'\n},{\n  value: 'play_solo',\n  label: 'Play Solo'\n},{\n  value: 'play_social',\n  label: 'Play Social'\n},{\n  value: 'head_tossing',\n  label: 'Head Tossing'\n},{\n  value: 'interacting',\n  label: 'Interacting with pen features'\n},{\n  value: 'drinking',\n  label: 'Drinking'\n},{\n  value: 'eating',\n  label: 'Eating'\n},{\n  value: 'fighting',\n  label: 'Fighting'\n},{\n  value: 'defacating',\n  label: 'Defacating'\n},{\n  value: 'other_active',\n  label: 'Other'\n},{\n  value: 'unknown',\n  label: 'Unknown'\n},]\n\nexport {behaviors};","const posture = [{\n    value: 'Lying sternally',\n    label: 'lying_sternally'\n  }, {\n    value: 'Sitting',\n    label: 'sitting'\n  }, {\n    value: 'Standing',\n    label: 'standing'\n  }, {\n    value: 'Walking ',\n    label: 'walking'\n  }, {\n    value: 'Consumption',\n    label: 'consumption'\n  }]\n\n  export {posture}","import React, { useState } from \"react\"; \nimport 'bootstrap/dist/css/bootstrap.min.css';\n\nimport BootstrapTable from 'react-bootstrap-table-next';\nimport cellEditFactory, { Type } from 'react-bootstrap-table2-editor';\nimport 'react-bootstrap-table-next/dist/react-bootstrap-table2.min.css';\n\nimport {behaviors} from '../../static_data/behaviors'\nimport {posture} from '../../static_data/posture'\n\nconst columns = [{\n    dataField: \"id\",\n    text: \"ID\"\n},{\n    dataField: \"behavior\",\n    text: \"Beh\",\n    editor: {\n        type: Type.SELECT,\n        options: behaviors\n      }\n},{\n    dataField: \"is_hidden\",\n    text: \"Hid\"\n},{\n    dataField: \"posture\",\n    text: \"Pos\",\n    editor: {\n        type: Type.SELECT,\n        options: posture\n      }\n}]\n\nfunction json_to_table_ANIKET(data){\n    var ret = []\n    if(data == null){\n        return []\n    }\n    for(var i = 0; i < data['objects'].length; i++){\n        const elem_id = i + 1\n        var curr_obj = data['objects'][i]\n        console.log(curr_obj['left'])\n        ret.push({id: elem_id.toString(), behavior: \"None\", is_hidden: \"False\", posture: \"None\"})        \n    }\n    return ret\n}\n\nfunction json_to_table(data){\n    var ret = []\n    if (data == null){\n        return []\n    }\n    for(var i = 0; i < data.length; i++){\n        ret.push(data[i].generate_row())\n    }\n    \n\n    return ret\n}\n\nfunction ChangeTable(input){\n    //console.log(input.data)\n    const data = json_to_table(input.data)\n    return (\n        <div style={{width: \"15%\"}}>\n            <BootstrapTable condensed={true} keyField='id' data={data} columns={ columns } cellEdit={ cellEditFactory({ mode: 'click', blurToSave: true }) }/>\n        </div>\n    )\n}\n\nexport default ChangeTable;","import { grep } from \"jquery\";\n\nconst fabric = require(\"fabric\").fabric;\n\nclass BoundingBox {\n    constructor(top, left, width, height, color, id, behavior) {\n        this.top = top;\n        this.left = left;\n        this.id = id;\n        this.behavior = behavior;\n        this.color = color;\n        this.width = width;\n        this.height = height;\n    }\n\n    rectangle(){\n        return new fabric.Rect({\n            hasRotatingPoint: false,\n            uniScaleTransform: true,\n            height: this.height,\n            width: this.width,\n            fill: this.color,\n            borderColor: '#000',\n            opacity: '.4',\n            top: this.top,\n            left: this.left,\n        });\n    } \n\n    //TODO Add text scaling\n    id_text(){\n        return new fabric.Text(this.id.toString(), {\n            fontSize: 20,\n            top: this.top,\n            left: this.left,\n            uniScaleTransform: false,\n          });\n    }\n\n    behavior(){\n\n    }\n\n    generate_no_behavior(canvas){\n        var group = new fabric.Group();\n        group.addWithUpdate(this.rectangle())\n        group.addWithUpdate(this.id_text())\n        \n        var temp = this.id \n        group.toObject = (function(toObject) {\n            return function(propertiesToInclude) {\n                return fabric.util.object.extend(toObject.call(this, propertiesToInclude), {\n                    local_id: temp\n                });\n            };\n        })(group.toObject);\n        //console.log(group.toJSON())\n\n        canvas.add(group)\n        return group\n    }\n\n    generate_with_behavior(){\n\n    }\n}\n\n\nfunction genetate_bounding_box(){\n\n}\n\nexport {BoundingBox, genetate_bounding_box}","import { BoundingBox } from \"./bounding_box\"\n\nclass FrameBoundingBox {\n    constructor(frame_data, canvas_width, canvas_height, video_height, vide_width){\n        this.frame_data = frame_data;\n        this.canvas_width = canvas_width;\n        this.canvas_height = canvas_height;\n        this.windowWidth = vide_width;\n        this.windowHeight = video_height;\n    }\n\n    generate_frame(){\n        var bounding_boxes = []\n        for (var i = 0; i < this.frame_data.length; i++){\n            var color = \"#\" + ((1<<24)*Math.random() | 0).toString(16)\n            console.log(this.frame_data[i])\n            var curr_box = new BoundingBox(this.getTop(this.frame_data[i]), this.getLeft(this.frame_data[i]), this.getWidth(this.frame_data[i]), this.getHeight(this.frame_data[i]), color, i, \"TEST\").generate_no_behavior()\n            bounding_boxes.push(curr_box);\n        }\n        return bounding_boxes\n    }\n\n    getID(data){\n        return data['id']\n    }\n\n    getWidth(data){\n        return Math.floor((data['bbox']['width']/this.windowWidth)*this.canvas_width)\n    }\n\n    getHeight(data){\n        return Math.floor((data['bbox']['height']/this.windowHeight)*this.canvas_height)\n    }\n\n    getTop(data){\n        return Math.floor((data['bbox']['y']/this.windowHeight)*this.canvas_height)\n    }\n\n    getLeft(data){\n        return Math.floor((data['bbox']['x']/this.windowWidth)*this.canvas_width)\n    }\n\n\n}\n\nexport {FrameBoundingBox}","const fabric = require(\"fabric\").fabric;\n\nclass KeyPoint {\n    //TODO Optimize this code. Right now there is a significant performance penalty if there are multiple keypoints on the canvas\n    generate_stick(canvas){\n        fabric.Object.prototype.originX = fabric.Object.prototype.originY = 'center';\n\n        function makeCircle(left, top, line1, line2, line3, line4) {\n            var c = new fabric.Circle({\n            left: left,\n            top: top,\n            strokeWidth: 2.5,\n            radius: 6,\n            fill: '#fff',\n            stroke: '#666'\n            });\n            c.hasControls = c.hasBorders = false;\n\n            c.line1 = line1;\n            c.line2 = line2;\n            c.line3 = line3;\n            c.line4 = line4;\n\n            return c;\n        }\n\n        function makeLine(coords) {\n            return new fabric.Line(coords, {\n            fill: 'red',\n            stroke: 'red',\n            strokeWidth: 5,\n            selectable: true,\n            evented: false,\n            });\n        }\n\n        var line = makeLine([ 250, 200, 250, 175 ]),\n            line2 = makeLine([ 250, 175, 250, 250 ]),\n            line3 = makeLine([ 250, 250, 300, 350]),\n            line4 = makeLine([ 250, 250, 200, 350]),\n            line5 = makeLine([ 250, 175, 175, 225 ]),\n            line6 = makeLine([ 250, 175, 325, 225 ]);\n\n        canvas.add(line, line2, line3, line4, line5, line6);\n\n        canvas.add(\n            makeCircle(line.get('x1'), line.get('y1'), null, line),\n            makeCircle(line.get('x2'), line.get('y2'), line, line2, line5, line6),\n            makeCircle(line2.get('x2'), line2.get('y2'), line2, line3, line4),\n            makeCircle(line3.get('x2'), line3.get('y2'), line3),\n            makeCircle(line4.get('x2'), line4.get('y2'), line4),\n            makeCircle(line5.get('x2'), line5.get('y2'), line5),\n            makeCircle(line6.get('x2'), line6.get('y2'), line6)\n        );\n\n        canvas.on('object:moving', function(e) {\n            var p = e.target;\n            p.line1 && p.line1.set({ 'x2': p.left, 'y2': p.top });\n            p.line2 && p.line2.set({ 'x1': p.left, 'y1': p.top });\n            p.line3 && p.line3.set({ 'x1': p.left, 'y1': p.top });\n            p.line4 && p.line4.set({ 'x1': p.left, 'y1': p.top });\n            canvas.renderAll();\n        });\n    }   \n\n\n    generate_poly(canvas){\n        \n    }\n}\n\nexport {KeyPoint}","const fabric = require(\"fabric\").fabric;\nconst $ = require(\"jquery\")\n\nclass Segmentation {\n    generate_polygon(canvas, id){\n        var min = 99;\n        var max = 999999;\n        var polygonMode = true;\n        var pointArray = new Array();\n        var lineArray = new Array();\n\n        var activeLine;\n        var activeShape = false;\n\n        var prototypefabric = new function () {\n                //canvas = window._canvas = new fabric.Canvas('c');\n                //canvas.setWidth($(window).width());\n                //canvas.setHeight($(window).height()-$('#nav-bar').height());\n                canvas.selection = false;\n        \n                canvas.on('mouse:down', function (options) {\n                    if(options.target && options.target.id === pointArray[0].id){\n                        prototypefabric.polygon.generatePolygon(pointArray);\n                    }\n                    if(polygonMode){\n                        prototypefabric.polygon.addPoint(options);\n                    }\n                });\n                canvas.on('mouse:up', function (options) {\n        \n                });\n                canvas.on('mouse:move', function (options) {\n                    if(activeLine && activeLine.class == \"line\"){\n                        var pointer = canvas.getPointer(options.e);\n                        activeLine.set({ x2: pointer.x, y2: pointer.y });\n        \n                        var points = activeShape.get(\"points\");\n                        points[pointArray.length] = {\n                            x:pointer.x,\n                            y:pointer.y\n                        }\n                        activeShape.set({\n                            points: points\n                        });\n                        canvas.renderAll();\n                    }\n                    canvas.renderAll();\n                });\n        }();\n        \n        \n        \n        prototypefabric.polygon = {\n            drawPolygon : function() {\n                polygonMode = true;\n                pointArray = new Array();\n                lineArray = new Array();\n            },\n            addPoint : function(options) {\n                var random = Math.floor(Math.random() * (max - min + 1)) + min;\n                var id = new Date().getTime() + random;\n                var circle = new fabric.Circle({\n                    radius: 5,\n                    fill: '#ffffff',\n                    stroke: '#333333',\n                    strokeWidth: 0.5,\n                    left: (options.e.layerX/canvas.getZoom()),\n                    top: (options.e.layerY/canvas.getZoom()),\n                    selectable: false,\n                    hasBorders: false,\n                    hasControls: false,\n                    originX:'center',\n                    originY:'center',\n                    id:id,\n                        objectCaching:false\n                });\n                if(pointArray.length === 0){\n                    circle.set({\n                        fill:'red'\n                    })\n                }\n                var points = [(options.e.layerX/canvas.getZoom()),(options.e.layerY/canvas.getZoom()),(options.e.layerX/canvas.getZoom()),(options.e.layerY/canvas.getZoom())];\n                var line = new fabric.Line(points, {\n                    strokeWidth: 2,\n                    fill: '#999999',\n                    stroke: '#999999',\n                    class:'line',\n                    originX:'center',\n                    originY:'center',\n                    selectable: false,\n                    hasBorders: false,\n                    hasControls: false,\n                    evented: false,\n                        objectCaching:false\n                });\n                if(activeShape){\n                    var pos = canvas.getPointer(options.e);\n                    var points = activeShape.get(\"points\");\n                    points.push({\n                        x: pos.x,\n                        y: pos.y\n                    });\n                    var polygon = new fabric.Polygon(points,{\n                        stroke:'#333333',\n                        strokeWidth:1,\n                        fill: '#cccccc',\n                        opacity: 0.3,\n                        selectable: false,\n                        hasBorders: false,\n                        hasControls: false,\n                        evented: false,\n                        objectCaching:false\n                    });\n                    canvas.remove(activeShape);\n                    canvas.add(polygon);\n                    activeShape = polygon;\n                    canvas.renderAll();\n                }\n                else{\n                    var polyPoint = [{x:(options.e.layerX/canvas.getZoom()),y:(options.e.layerY/canvas.getZoom())}];\n                    var polygon = new fabric.Polygon(polyPoint,{\n                        stroke:'#333333',\n                        strokeWidth:1,\n                        fill: '#cccccc',\n                        opacity: 0.3,\n                        selectable: false,\n                        hasBorders: false,\n                        hasControls: false,\n                        evented: false,\n                        objectCaching:false\n                    });\n                    activeShape = polygon;\n                    canvas.add(polygon);\n                }\n                activeLine = line;\n        \n                pointArray.push(circle);\n                lineArray.push(line);\n        \n                canvas.add(line);\n                canvas.add(circle);\n                canvas.selection = false;\n            },\n            generatePolygon : function(pointArray){\n                var points = new Array();\n                $.each(pointArray,function(index,point){\n                    points.push({\n                        x:point.left,\n                        y:point.top\n                    });\n                    canvas.remove(point);\n                });\n                $.each(lineArray,function(index,line){\n                    canvas.remove(line);\n                });\n\n                console.log(pointArray)\n                console.log(lineArray)\n\n\n                var group = new fabric.Group()\n                for (var i = 0; i < pointArray.length; i++){\n                    group.addWithUpdate(pointArray[i])\n                    group.addWithUpdate(lineArray[i])\n                }\n                \n                /*group.addWithUpdate(new fabric.Text(id.toString(), {\n                    fontSize: 20,\n                    centerX: \"center\",\n                    top: pointArray[0].top,\n                    left: pointArray[0].left, \n                    uniScaleTransform: false,\n                  }));\n                */\n               //To add custom id\n                group.toObject = (function(toObject) {\n                    return function(propertiesToInclude) {\n                        return fabric.util.object.extend(toObject.call(this, propertiesToInclude), {\n                            local_id: id\n                        });\n                    };\n                })(group.toObject);\n\n                canvas.add(group)\n                  \n                canvas.remove(activeLine);\n                canvas.remove(activeShape)\n                //canvas.add(polygon);\n        \n                activeLine = null;\n                activeShape = null;\n                polygonMode = false;\n                canvas.selection = true;\n\n                return group\n            }\n        };\n        \n        \n        //return prototypefabric.polygon.drawPolygon();\n    }\n}\n\nexport {Segmentation}","import React, { useEffect, useState } from \"react\"; \nimport ReactDOM from 'react-dom'\nimport ReactPlayer from 'react-player'\nimport 'bootstrap/dist/css/bootstrap.min.css';\n\nimport Button from 'react-bootstrap/Button'\nimport Navbar from 'react-bootstrap/Navbar'\nimport Nav from 'react-bootstrap/Nav'\nimport Modal from 'react-bootstrap/Modal'\nimport Form from 'react-bootstrap/Form'\nimport Toast from 'react-bootstrap/Toast'\n\n\nimport AnnotationProcessing from '../../backend_processing/annotation-processing'\nimport ChangeTable from '../Components/change_table'\nimport { NavDropdown } from \"react-bootstrap\";\n\n//Custom implemented classes\nimport { BoundingBox } from '../../backend_processing/bounding_box'\nimport { FrameBoundingBox } from '../../backend_processing/frame_bounding_box'\nimport { KeyPoint } from '../../backend_processing/key_point'\nimport { Segmentation } from '../../backend_processing/segmentation'\nimport { Annotation } from '../../backend_processing/annotation'\n\nimport BootstrapTable from 'react-bootstrap-table-next';\nimport cellEditFactory, { Type } from 'react-bootstrap-table2-editor';\nimport 'react-bootstrap-table-next/dist/react-bootstrap-table2.min.css';\nimport {behaviors} from '../../static_data/behaviors'\nimport {posture} from '../../static_data/posture'\n\n\nconst columns = [{\n  dataField: \"id\",\n  text: \"ID\"\n},{\n  dataField: \"global_id\",\n  text: \"Glo\"\n},{\n  dataField: \"behavior\",\n  text: \"Beh\",\n  editor: {\n      type: Type.SELECT,\n      options: behaviors\n    }\n},{\n  dataField: \"is_hidden\",\n  text: \"Hid\"\n},{\n  dataField: \"posture\",\n  text: \"Pos\",\n  editor: {\n      type: Type.SELECT,\n      options: posture\n    }\n}]\n\n\nconst fabric = require(\"fabric\").fabric;\nconst createReactClass = require('create-react-class');\n\n\n//TODO ADD DYNAMIC SOLUTION \nvar frame_rate = 15;\nvar num_frames = 7200;\nconst scaling_factor_height = 1080;\nconst scaling_factor_width = 1920;\nvar skip_value = 1;\n\n// globally accessable fabricCanvas instance\nvar fabricCanvas = new fabric.Canvas('c', {uniScaleTransform: true});\n\n\nvar Fabric = createReactClass({\n\tcomponentDidMount() {\n  \tvar el = ReactDOM.findDOMNode(this);\n    \n    // Here we have the canvas so we can initialize fabric\n    fabricCanvas.initialize(el, {\n    \theight: 1080,\n      width: 1920,\n      backgroundColor : null,\n    });\n    \n    // on mouse up lets save some state\n    fabricCanvas.on('mouse:up', () => {\n      //frame_data[global_currFrame] = fabricCanvas.toJSON()\n    });\n\n    \n    // an event we will fire when we want to save state\n    fabricCanvas.on('saveData', () => {\n      fabricCanvas.renderAll(); // programatic changes we make will not trigger a render in fabric\n    });\n  }, \n  render() {\n    return <canvas></canvas>\n  }\n});\n\nvar frame_data = [[]];\nvar annotation_data = [[]];\nvar upload = false;\nvar disable_buttons = true;\nvar global_currFrame = 0;\nvar toast_text = \"\"\n\n//Current frame counter\nfunction MainUpload() {\n  \n  const [annotationType, setAnnotationType] = useState(0)\n  const handleAnnotationType = (event) => {\n    console.log(event.target.value)\n  }\n  \n  const [boxCount, setBoxCount] = useState(0)\n  const addToCanvas = () =>{\n    var color = \"#\" + ((1<<24)*Math.random() | 0).toString(16)\n    \n    if(annotation_data[currentFrame] == null){\n      annotation_data[currentFrame] = []\n    }\n\n    if (annotationType === 0){\n      annotation_data[currentFrame].push({id: boxCount, behavior: \"None\", is_hidden: 0, posture: \"None\"})\n      var new_bbox = new BoundingBox(fabricCanvas.height/2, fabricCanvas.width/2, 50, 50, color, boxCount, \"None\", fabricCanvas).generate_no_behavior(fabricCanvas)\n      //annotation_data[currentFrame].push(new Annotation(boxCount, \"None\", \"None\", 0,0, new_bbox))\n      //fabricCanvas.add(new_bbox)\n      fabricCanvas.setActiveObject(new_bbox);\n    }else if (annotationType === 1){\n      annotation_data[currentFrame].push({id: boxCount, behavior: \"None\", is_hidden: 0, posture: \"None\"})\n      var keyp = new KeyPoint().generate_stick(fabricCanvas)\n    }else if (annotationType === 2){\n      annotation_data[currentFrame].push({id: boxCount, behavior: \"None\", is_hidden: 0, posture: \"None\"})\n      var segment = new Segmentation().generate_polygon(fabricCanvas, boxCount)\n    }\n\n    setBoxCount(boxCount + 1);\n    fabricCanvas.fire('saveData');\n  }\n\n  const remove = () => {\n    setBoxCount(boxCount + 1)\n    var index = fabricCanvas.getActiveObject().toJSON()['local_id']\n    console.log(fabricCanvas.getActiveObject().toJSON())\n    for(var i = 0; i < annotation_data[currentFrame].length; i++){\n      if (annotation_data[currentFrame][i]['id'] === index){\n        annotation_data[currentFrame].splice(i, 1)\n        break;\n      }\n    }\n    fabricCanvas.remove(fabricCanvas.getActiveObject());\n    fabricCanvas.fire('saveData');\n  }\n\n  const [videoFilePath, setVideoFileURL] = useState(null);\n  const handleVideoUpload = (event) => {\n    //console.log(oldAnnotation)\n    setVideoFileURL(URL.createObjectURL(event.target.files[0]));\n    upload = true;\n  };\n\n  //Code for dual video upload option. Currently disabled\n  const [videoFilePath1, setVideoFileURL1] = useState(null);\n  const handleVideoUpload1 = (event) => {\n    setVideoFileURL1(URL.createObjectURL(event.target.files[0]));\n  };\n  \n  //ASYNC Function  - To note that the data that comes out of this will be a bit delayed and this could cause some issues.\n  const [oldAnnotation, setOldAnnotation] = useState(null)\n  const handleOldAnnotation = (event) => {\n      var promise = downloadOldAnnotation(event)\n      promise.then(function (result) {\n        if(result != null){\n          setOldAnnotation(new AnnotationProcessing(result));\n        }else{\n          console.log(\"ERROR in upload old_annotation\")\n        }\n      })\n  }\n\n  useEffect(() => {\n    //TODO Find a more elegant solution. This is a temporay patch work.\n    if(oldAnnotation == null){\n      return;\n    }\n    console.log(oldAnnotation)\n    console.log(oldAnnotation.getAllObjectByFrame(2));\n  }, oldAnnotation);\n\n  const downloadOldAnnotation = (file) => {\n    return new Promise((resolve, reject) => {\n      var reader = new FileReader();\n      reader.onload = function(e) {\n         resolve((JSON.parse(e.target.result)));\n      }\n      reader.readAsText(file.target.files[0])\n    })\n  }\n  \n\n  const [playing, setPlaying] = useState(false);\n  const handlePlaying = (event) => {\n    setPlaying(!playing)\n  }\n\n  var play_button_text = \"ERROR\"\n  if(playing === true){\n    play_button_text = \"Pause\"\n  }else{\n  play_button_text = \"Play\"\n  }\n\n  const [seeking, setSeeking] = useState(false)\n  const [sliderPercent, setSliderPercent] = useState(0)\n\n  const handleSeekChange = e => {\n    setSliderPercent(parseFloat(e.target.value))\n  }\n\n  const handleSeekMouseDown = e => {\n    setSeeking(true)\n  }\n\n  const handleSeekMouseUp = e => {\n    setSeeking(false)\n    player.seekTo(parseFloat(e.target.value))\n  }\n\n  const [player, setPlayer] = useState(null)\n  const handleSetPlayer = val => {\n    setPlayer(val)\n    if(upload === true && player != null){      \n      console.log(\"RESET VALUES\")\n      frame_data = new Array(num_frames)\n      annotation_data = new Array(num_frames)\n      //TODO Update this later\n      for (var i = 0; i < 7200; i++){\n        frame_data[i] = []\n        annotation_data[i] = []\n      }\n      upload = false;\n      disable_buttons = false\n    }\n  }\n\n  const [duration, setDuration] = useState(0);\n  const handleSetDuration = val => {\n    setDuration(parseInt(val))\n    console.log(val)\n  }\n\n\n  const [currentFrame, setCurrentFrame] = useState(0)\n  const handleSetCurrentFrame = val => {\n    var total_frames = duration * frame_rate\n    setSliderPercent(currentFrame/total_frames)\n    setCurrentFrame(Math.round(val['played']*total_frames))\n    global_currFrame = currentFrame\n\n\n\n    if(oldAnnotation != null){ \n      fabricCanvas.clear();\n      var bbox = new FrameBoundingBox(oldAnnotation.getAllObjectByFrame(currentFrame), scaling_factor_width, scaling_factor_height).generate_frame()\n      for(var i = 0; i < bbox.length; i++){\n        var curr_obj = bbox[i]\n        console.log(curr_obj)\n        fabricCanvas.add(curr_obj);\n        fabricCanvas.setActiveObject(curr_obj);\n        fabricCanvas.fire('saveData');\n      }\n    }\n\n  }\n\n  const skip_frame_forward = e =>{\n    var total_frames = duration * frame_rate\n    player.seekTo((((player.getCurrentTime()/duration)*total_frames)+skip_value)/(total_frames))\n  }\n\n  const skip_frame_backward = e => {\n    var total_frames = duration * frame_rate\n    player.seekTo((((player.getCurrentTime()/duration)*total_frames)-skip_value)/(total_frames))\n  }\n\n  //frame_data[currentFrame] = fabricCanvas.toJSON()\n\n  const downloadFile = async () => {\n    const fileName = \"generated_annotations\";\n    //const json = JSON.stringify(fabricCanvas.getObjects());\n    const json = JSON.stringify(frame_data);\n    const blob = new Blob([json],{type:'application/json'});\n    const href = await URL.createObjectURL(blob);\n    const link = document.createElement('a');\n    link.href = href;\n    link.download = fileName + \".json\";\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n  }\n\n  const [show, setShow] = useState(false);\n\n  const handleClose = () => setShow(false);\n  const handleShow = () => setShow(true);\n\n  const handleSquareBox = () => {\n    setAnnotationType(0);\n  }\n\n  const handleKeyPoint = () => {\n    setAnnotationType(1);\n  }\n\n  const handleSegmentation = () => {\n    setAnnotationType(2);\n  }\n\n  const [save, changeSave] = useState(false);\n  \n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  const onKeyPress = (event) =>{\n    if(event.key === \"3\") {\n      toast_text = \"Mode Switch: Segmentation\"\n      changeSave(true)\n      handleSegmentation()\n    }else if (event.key === \"1\"){\n      toast_text = \"Mode Switch: Bounding Box\"\n      changeSave(true)\n      handleSquareBox()\n    }else if (event.key === \"2\"){\n      toast_text = \"Mode Switch: Key Point\"\n      changeSave(true)\n      handleKeyPoint()\n    }else if (event.key === \"a\"){\n      toast_text = \"Added Annotation\"\n      changeSave(true)\n      addToCanvas()\n    }else if (event.key === \"r\"){\n      toast_text = \"Removed Annotation\"\n      changeSave(true)\n      remove()\n    }else if (event.key === \"q\"){\n      skip_frame_backward()\n    }\n    else if (event.key === \"w\"){\n      handlePlaying()\n    }\n    else if (event.key === \"e\"){\n      skip_frame_forward()\n    }else if (event.key === \"s\"){\n      toast_text = \"Annotation Saved\"\n      changeSave(true)\n      frame_data[currentFrame] = fabricCanvas.toJSON()\n    }\n  }  \n \n  useEffect(() => {\n    document.addEventListener(\"keydown\", onKeyPress);\n    return () => document.removeEventListener(\"keydown\", onKeyPress);\n  }, [onKeyPress]);\n  \n  useEffect(() => {\n    fabricCanvas.clear()\n    console.log(currentFrame)\n    fabricCanvas.loadFromJSON(frame_data[currentFrame], function() {\n      console.log(frame_data[currentFrame])\n      fabricCanvas.renderAll();\n    });\n  }, [currentFrame]);\n\n  return (\n    <div>\n      <Navbar bg=\"dark\" variant=\"dark\" className=\"bg-5\">\n          <Navbar.Brand href=\"#home\">Annotation Tool</Navbar.Brand>\n          <Nav className=\"mr-auto\">\n              <Nav.Link onClick={handleShow}>Instructions</Nav.Link>\n\n              <NavDropdown disabled={disable_buttons} title=\"Annotation Type\" id=\"basic-nav-dropdown\">\n                <NavDropdown.Item onClick={handleSquareBox} >Square Box</NavDropdown.Item>\n                <NavDropdown.Divider />\n                <NavDropdown.Item onClick={handleKeyPoint}>Key Point</NavDropdown.Item>\n                <NavDropdown.Divider />\n                <NavDropdown.Item onClick={handleSegmentation}>Segmentation</NavDropdown.Item>\n              </NavDropdown>\n\n              <NavDropdown disabled={disable_buttons} title=\"Export\" id=\"basic-nav-dropdown\">\n                <NavDropdown.Item onClick={downloadFile}>JSON</NavDropdown.Item>\n                <NavDropdown.Divider />\n                <NavDropdown.Item >CSV</NavDropdown.Item>\n              </NavDropdown>\n\n              <NavDropdown disabled={disable_buttons} title=\"Settings\" id=\"basic-nav-dropdown\">\n                <NavDropdown.Divider />\n                Frame Rate: <input type=\"number\" defaultValue=\"15\"></input>\n                <NavDropdown.Divider />\n                Horizontal Res: <input type='number' defaultValue=\"3840\"></input>\n                <NavDropdown.Divider />\n                Vertical Res: <input type='number' defaultValue=\"2178\"></input>\n                <NavDropdown.Divider />\n                Skip Value: <input type='number' defaultValue=\"1\" onChange={(event) => {skip_value = event.target.value}}></input>\n              </NavDropdown>\n          </Nav>\n\n          <div>\n            <Form style={{float: \"left\", width: 80}}>\n              <Form.File disabled={disable_buttons} id=\"file\" label=\"Annotation Upload\" custom type=\"file\" onChange={handleOldAnnotation}/>\n            </Form>\n            <Form style={{float: \"left\", width: 80}}>\n              <Form.File id=\"file\" label=\"Video Upload\" accept=\".mp4\" custom type=\"file\" onChange={handleVideoUpload} />\n            </Form>\n            <Button variant=\"secondary\" disabled={true}>Frame # {parseInt(currentFrame)+' / '+parseInt(duration * frame_rate)}</Button>{' '}\n            <Button variant=\"primary\" disabled={disable_buttons} onClick={skip_frame_backward}>Prev</Button>{' '}\n            <Button variant=\"primary\" disabled={disable_buttons} onClick={handlePlaying}>{play_button_text}</Button>{' '}\n            <Button variant=\"primary\" disabled={disable_buttons} onClick={skip_frame_forward}>Next</Button>{' '}\n            <Button variant=\"success\" disabled={disable_buttons} onClick={addToCanvas} style={{position:\"relative\"}}>Add</Button>{' '}\n            <Button variant=\"danger\" onClick={remove} disabled={disable_buttons} style={{position:\"relative\"}}>Remove</Button>{' '}\n          </div>\n      </Navbar>\n      <Toast onClose={() => changeSave(false)} show={save} delay={500} autohide\n          style={{\n            position: 'absolute',\n            top: '00%',\n            left: '50%',\n          }}>\n        <Toast.Header>\n          <strong className=\"mr-auto\">{toast_text}</strong>\n        </Toast.Header>\n      </Toast>\n      <Modal show={show} onHide={handleClose}>\n          <Modal.Header closeButton>\n          <Modal.Title>Instructions</Modal.Title>\n          </Modal.Header>\n          <Modal.Body>TODO: Add instructions</Modal.Body>\n          <Modal.Footer>\n          <Button variant=\"secondary\" onClick={handleClose}>Close</Button>\n          </Modal.Footer>\n      </Modal>\n      <div style={{display: \"grid\"}}>\n        <div style={{gridColumn: 1, gridRow:1, position: \"relative\", width: scaling_factor_width, height: scaling_factor_height, top: 0, left: 0}}>\n          <ReactPlayer \n            onProgress={handleSetCurrentFrame} \n            ref={handleSetPlayer} \n            onDuration={handleSetDuration} \n            url={videoFilePath} \n            width='100%'\n            height='99.999%'\n            playing={playing} \n            controls={false} \n            style={{position:'absolute', float:'left', top:0, left:0}}\n            volume={0}\n            muted={true}\n            pip={false}\n          />\n        </div>\n        <div style={{gridColumn: 1, gridRow:1, position: \"relative\", width: scaling_factor_width, height: scaling_factor_height, top: 0, left: 0}}>\n          <Fabric/>\n        </div>\n        <div style={{gridColumn: 1, gridRow:2, position: \"relative\", width: scaling_factor_width, top: 0, left: 0}}>\n\n          <input\n            style={{width: scaling_factor_width}}\n            type='range' min={0} max={0.999999} step='any'\n            value={sliderPercent}\n            onMouseDown={handleSeekMouseDown}\n            onChange={handleSeekChange}\n            onMouseUp={handleSeekMouseUp}\n          />\n        </div>\n        <div style={{gridColumn: 2, gridRow:1, position: \"relative\", width: scaling_factor_width, height: scaling_factor_height, top: 0, left: 0}}>\n          <div style={{width: \"15%\"}}>\n              <BootstrapTable \n                keyField='id' \n                data={annotation_data[currentFrame]} \n                columns={ columns } \n                cellEdit={ \n                  cellEditFactory({ mode: 'click', blurToSave: true, afterSaveCell: (oldValue, newValue, row, column) => {\n                    annotation_data[currentFrame][row['id']] = row\n                  } }) \n                }\n              />\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\n\nexport default MainUpload;","import React, { useEffect, useState } from \"react\"; \nimport ReactDOM from 'react-dom'\nimport ReactPlayer from 'react-player'\nimport 'bootstrap/dist/css/bootstrap.min.css';\n\nimport Button from 'react-bootstrap/Button'\nimport Navbar from 'react-bootstrap/Navbar'\nimport Nav from 'react-bootstrap/Nav'\nimport Modal from 'react-bootstrap/Modal'\nimport Form from 'react-bootstrap/Form'\n\n\nimport AnnotationProcessing from '../../backend_processing/annotation-processing'\nimport ChangeTable from '../Components/change_table'\nimport { NavDropdown } from \"react-bootstrap\";\n\n//Custom implemented classes\nimport { BoundingBox } from '../../backend_processing/bounding_box'\nimport { FrameBoundingBox } from '../../backend_processing/frame_bounding_box'\nimport { KeyPoint } from '../../backend_processing/key_point'\nimport { Segmentation } from '../../backend_processing/segmentation'\n\nconst fabric = require(\"fabric\").fabric;\nconst Nuclear = require(\"nuclear-js\");\nconst createReactClass = require('create-react-class');\n\n\n//TODO ADD DYNAMIC SOLUTION \nvar frame_rate = 15;\nvar num_frames = 7200;\nconst scaling_factor_height = 1080;\nconst scaling_factor_width = 1920;\n\n// globally accessable fabricCanvas instance\nvar fabricCanvas = new fabric.Canvas('c', {uniScaleTransform: true});\n\n\nvar Fabric = createReactClass({\n\tcomponentDidMount() {\n  \tvar el = ReactDOM.findDOMNode(this);\n    \n    // Here we have the canvas so we can initialize fabric\n    fabricCanvas.initialize(el, {\n    \theight: 1080,\n      width: 1920,\n      backgroundColor : null,\n    });\n    \n    // on mouse up lets save some state\n    fabricCanvas.on('mouse:up', () => {\n      frame_data[global_currFrame] = fabricCanvas.toJSON()\n    });\n\n    \n    // an event we will fire when we want to save state\n    fabricCanvas.on('saveData', () => {\n      fabricCanvas.renderAll(); // programatic changes we make will not trigger a render in fabric\n    });\n  }, \n  render() {\n    return <canvas></canvas>\n  }\n});\n\nvar frame_data = [];\nvar annotation_data = [];\nvar upload = false;\nvar global_currFrame = 0;\n\n//Current frame counter\nfunction MainYoutube() {\n  \n  const [annotationType, setAnnotationType] = useState(0)\n  const handleAnnotationType = (event) => {\n    console.log(event.target.value)\n  }\n  \n  const [boxCount, setBoxCount] = useState(0)\n  const addToCanvas = () =>{\n    var color = \"#\" + ((1<<24)*Math.random() | 0).toString(16)\n    \n    if (annotationType === 0){\n      var new_bbox = new BoundingBox(fabricCanvas.height/2, fabricCanvas.width/2, 50, 50, color, boxCount, \"None\").generate_no_behavior()\n      fabricCanvas.add(new_bbox)\n      fabricCanvas.setActiveObject(new_bbox);\n    }else if (annotationType === 1){\n      var test = new KeyPoint().generate_stick(fabricCanvas)\n    }else if (annotationType === 2){\n      var test1 = new Segmentation().generate_polygon(fabricCanvas, boxCount)\n    }\n\n    setBoxCount(boxCount + 1);\n    fabricCanvas.fire('saveData');\n  }\n\n  const remove = () => {\n    setBoxCount(boxCount + 1)\n    fabricCanvas.remove(fabricCanvas.getActiveObject());\n    fabricCanvas.fire('saveData');\n  }\n\n  const [videoFilePath, setVideoFileURL] = useState(null);\n  const handleVideoUpload = (event) => {\n    //console.log(oldAnnotation)\n    setVideoFileURL(URL.createObjectURL(event.target.files[0]));\n    upload = true;\n  };\n\n  //Code for dual video upload option. Currently disabled\n  const [videoFilePath1, setVideoFileURL1] = useState(null);\n  const handleVideoUpload1 = (event) => {\n    setVideoFileURL1(URL.createObjectURL(event.target.files[0]));\n  };\n  \n  //ASYNC Function  - To note that the data that comes out of this will be a bit delayed and this could cause some issues.\n  const [oldAnnotation, setOldAnnotation] = useState(null)\n  const handleOldAnnotation = (event) => {\n      var promise = downloadOldAnnotation(event)\n      promise.then(function (result) {\n        if(result != null){\n          setOldAnnotation(new AnnotationProcessing(result));\n        }else{\n          console.log(\"ERROR in upload old_annotation\")\n        }\n      })\n  }\n\n  useEffect(() => {\n    //TODO Find a more elegant solution. This is a temporay patch work.\n    if(oldAnnotation == null){\n      return;\n    }\n    console.log(oldAnnotation)\n    console.log(oldAnnotation.getAllObjectByFrame(2));\n  }, oldAnnotation);\n\n  const downloadOldAnnotation = (file) => {\n    return new Promise((resolve, reject) => {\n      var reader = new FileReader();\n      reader.onload = function(e) {\n         resolve((JSON.parse(e.target.result)));\n      }\n      reader.readAsText(file.target.files[0])\n    })\n  }\n  \n\n  const [playing, setPlaying] = useState(false);\n  const handlePlaying = (event) => {\n    setPlaying(!playing)\n  }\n\n  var play_button_text = \"ERROR\"\n  if(playing === true){\n    play_button_text = \"Pause\"\n  }else{\n    play_button_text = \"Play\"\n  }\n\n  const [seeking, setSeeking] = useState(false)\n  const [sliderPercent, setSliderPercent] = useState(0)\n\n  const handleSeekChange = e => {\n    setSliderPercent(parseFloat(e.target.value))\n  }\n\n  const handleSeekMouseDown = e => {\n    setSeeking(true)\n  }\n\n  const handleSeekMouseUp = e => {\n    setSeeking(false)\n    player.seekTo(parseFloat(e.target.value))\n  }\n\n  const [player, setPlayer] = useState(null)\n  const handleSetPlayer = val => {\n    setPlayer(val)\n    if(upload === true && player != null){      \n      console.log(\"RESET VALUES\")\n      frame_data = new Array(num_frames)\n      annotation_data = new Array(num_frames)\n      //TODO Update this later\n      for (var i = 0; i < 7200; i++){\n        frame_data[i] = []\n      }\n      upload = false;\n    }\n  }\n\n  const [duration, setDuration] = useState(0);\n  const handleSetDuration = val => {\n    setDuration(parseInt(val))\n    console.log(val)\n  }\n\n  var tot = 0\n\n  const [currentFrame, setCurrentFrame] = useState(0)\n  const handleSetCurrentFrame = val => {\n    console.log(val)\n    var total_frames = duration * frame_rate\n    tot = total_frames\n    setSliderPercent(currentFrame/total_frames)\n    setCurrentFrame(Math.round(val['played']*total_frames))\n    global_currFrame = currentFrame\n\n    if(oldAnnotation != null){ \n      fabricCanvas.clear();\n      var bbox = new FrameBoundingBox(oldAnnotation.getAllObjectByFrame(currentFrame), scaling_factor_width, scaling_factor_height).generate_frame()\n      for(var i = 0; i < bbox.length; i++){\n        var curr_obj = bbox[i]\n        console.log(curr_obj)\n        fabricCanvas.add(curr_obj);\n        fabricCanvas.setActiveObject(curr_obj);\n        fabricCanvas.fire('saveData');\n      }\n    }\n\n  }\n\n  const [numBoundingBox, setNumBoundingBox] = useState(0)\n  const handleNumBoundingBox = val => {\n    setNumBoundingBox(numBoundingBox + 1);\n    \n  }\n\n\n  const skip_frame_forward = e =>{\n    var total_frames = duration * frame_rate\n    //frame_data[currentFrame] = fabricCanvas.toJSON()\n    console.log(currentFrame)\n    console.log(frame_data)\n    player.seekTo((((player.getCurrentTime()/duration)*total_frames)+1)/(total_frames))\n  }\n\n  const skip_frame_backward = e => {\n    var total_frames = duration * frame_rate\n    player.seekTo((((player.getCurrentTime()/duration)*total_frames)-1)/(total_frames))\n  }\n\n  //frame_data[currentFrame] = fabricCanvas.toJSON()\n\n  const downloadFile = async () => {\n    const fileName = \"generated_annotations\";\n    //const json = JSON.stringify(fabricCanvas.getObjects());\n    const json = JSON.stringify(frame_data);\n    const blob = new Blob([json],{type:'application/json'});\n    const href = await URL.createObjectURL(blob);\n    const link = document.createElement('a');\n    link.href = href;\n    link.download = fileName + \".json\";\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n  }\n\n  const [show, setShow] = useState(false);\n\n  const handleClose = () => setShow(false);\n  const handleShow = () => setShow(true);\n\n  const handleSquareBox = () => {\n    setAnnotationType(0);\n  }\n\n  const handleKeyPoint = () => {\n    setAnnotationType(1);\n  }\n\n  const handleSegmentation = () => {\n    setAnnotationType(2);\n  }\n  \n  const onKeyPress = (event) =>{\n    if(event.key === \"s\") {\n      handleSegmentation()\n    }else if (event.key === \"b\"){\n      handleSquareBox()\n    }else if (event.key === \"k\"){\n      handleKeyPoint()\n    }else if (event.key === \"a\"){\n      addToCanvas()\n    }\n  }  \n \n  useEffect(() => {\n    document.addEventListener(\"keydown\", onKeyPress);\n    return () => document.removeEventListener(\"keydown\", onKeyPress);\n  }, [onKeyPress]);\n\n  return (\n    <div>\n      <Navbar bg=\"dark\" variant=\"dark\" className=\"bg-5\">\n          <Navbar.Brand href=\"#home\">Annotation Tool</Navbar.Brand>\n          <Nav className=\"mr-auto\">\n              <Nav.Link onClick={handleShow}>Instructions</Nav.Link>\n\n              <NavDropdown title=\"Annotation Type\" id=\"basic-nav-dropdown\">\n                <NavDropdown.Item onClick={handleSquareBox} >Square Box</NavDropdown.Item>\n                <NavDropdown.Divider />\n                <NavDropdown.Item onClick={handleKeyPoint}>Key Point</NavDropdown.Item>\n                <NavDropdown.Divider />\n                <NavDropdown.Item onClick={handleSegmentation}>Segmentation</NavDropdown.Item>\n              </NavDropdown>\n\n              <NavDropdown title=\"Export\" id=\"basic-nav-dropdown\">\n                <NavDropdown.Item onClick={downloadFile}>JSON</NavDropdown.Item>\n                <NavDropdown.Divider />\n                <NavDropdown.Item >CSV</NavDropdown.Item>\n              </NavDropdown>\n\n              <NavDropdown title=\"Settings\" id=\"basic-nav-dropdown\">\n                <NavDropdown.Divider />\n                Frame Rate: <input type=\"text\" value=\"15\"></input>\n                <NavDropdown.Divider />\n                Horizontal Res: <input type='text>' value=\"3840\"></input>\n                <NavDropdown.Divider />\n                Vertical Res: <input type='text>' value=\"2178\"></input>\n              </NavDropdown>\n          </Nav>\n          <div>\n            <Button variant=\"secondary\" disabled=\"true\">Frame # {parseInt(currentFrame)+' / '+parseInt(duration * frame_rate)}</Button>\n            <Form style={{float: \"left\", width: 80}}>\n              <Form.File id=\"file\" label=\"Annotation Upload\" custom type=\"file\" onChange={handleOldAnnotation}/>\n            </Form>\n            <Form style={{float: \"left\", width: 80}}>\n              <Form.File id=\"file\" label=\"Video Upload\" accept=\".mp4\" custom type=\"file\" onChange={handleVideoUpload} />\n            </Form>\n            <Button variant=\"primary\" onClick={skip_frame_backward}>Prev</Button>{' '}\n            <Button variant=\"primary\" onClick={handlePlaying}>{play_button_text}</Button>{' '}\n            <Button variant=\"primary\" onClick={skip_frame_forward}>Next</Button>{' '}\n            \n            <div style={{float: \"right\"}}>\n              <Button onClick={addToCanvas} style={{position:\"relative\"}}>Add</Button>{' '}\n              <Button onClick={remove} style={{position:\"relative\"}}>Remove</Button>{' '}\n            </div>\n\n          </div>\n      </Navbar>\n      <Modal show={show} onHide={handleClose}>\n          <Modal.Header closeButton>\n          <Modal.Title>Instructions</Modal.Title>\n          </Modal.Header>\n          <Modal.Body>TODO: Add instructions</Modal.Body>\n          <Modal.Footer>\n          <Button variant=\"secondary\" onClick={handleClose}>Close</Button>\n          </Modal.Footer>\n      </Modal>\n      <div style={{display: \"grid\"}}>\n        <div style={{gridColumn: 1, gridRow:1, position: \"relative\", width: scaling_factor_width, height: scaling_factor_height, top: 0, left: 0}}>\n          <ReactPlayer \n            onProgress={handleSetCurrentFrame} \n            ref={handleSetPlayer} \n            onDuration={handleSetDuration} \n            url={\"https://www.youtube.com/watch?v=MF6J2H983HY\"} \n            width='100%'\n            height='99.999%'\n            playing={playing} \n            controls={false} \n            style={{position:'absolute', float:'left', top:0, left:0}}\n            volume={0}\n            muted={true}\n            pip={false}\n          />\n        </div>\n        <div style={{gridColumn: 1, gridRow:1, position: \"relative\", width: scaling_factor_width, height: scaling_factor_height, top: 0, left: 0}}>\n          <Fabric/>\n        </div>\n        <div style={{gridColumn: 1, gridRow:2, position: \"relative\", width: scaling_factor_width, top: 0, left: 0}}>\n\n          <input\n            style={{width: scaling_factor_width}}\n            type='range' min={0} max={0.999999} step='any'\n            value={sliderPercent}\n            onMouseDown={handleSeekMouseDown}\n            onChange={handleSeekChange}\n            onMouseUp={handleSeekMouseUp}\n          />\n        </div>\n        <div style={{gridColumn: 2, gridRow:1, position: \"relative\", width: scaling_factor_width, height: scaling_factor_height, top: 0, left: 0}}>\n        </div>\n      </div>\n    </div>\n  );\n}\n\n//<ChangeTable data={frame_data[currentFrame]} style={{ float: \"right\"}}/>\n\nexport default MainYoutube;","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nimport MainUpload from './ui_elements/Pages/main_upload'\n\nReactDOM.render(\n  <React.StrictMode>\n    <MainUpload></MainUpload>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}