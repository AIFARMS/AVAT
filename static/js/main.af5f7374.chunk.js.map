{"version":3,"sources":["processing/annotation-processing.js","annotations/bounding_box.js","annotations/key_point.js","annotations/segmentation.js","static_data/behaviors.js","static_data/posture.js","static_data/status.js","static_data/columns.js","ui_elements/Components/instructions.js","processing/misc.js","ui_elements/Components/nav_bar.js","ui_elements/Components/fabric_canvas.js","ui_elements/Pages/main_upload.js","static_data/constants.js","ui_elements/Pages/main_youtube.js","ui_elements/Components/change_table.js","static_data/behaviors_LPS.js","ui_elements/Pages/main_muiltiview.js","ui_elements/Pages/selection_screen.js","App.js","serviceWorker.js","index.js"],"names":["ExtractingAnnotation","annotation_json","this","frame_data","annotation_data","fabric","require","BoundingBox","top","left","width","height","color","id","behavior","Rect","hasRotatingPoint","uniScaleTransform","fill","borderColor","opacity","Text","toString","fontSize","canvas","group","Group","addWithUpdate","rectangle","id_text","toObject","temp","propertiesToInclude","util","object","extend","call","local_id","console","log","toJSON","on","obj","circle","target","item","scaleX","scaleY","set","isDown","origX","origY","o","pointer","getPointer","e","x","y","rect_temp","originX","originY","angle","transparentCorners","add","Math","abs","renderAll","off","$","Segmentation","activeLine","polygonMode","pointArray","Array","lineArray","activeShape","forEachObject","selectable","prototypefabric","selection","options","polygon","generatePolygon","addPoint","class","x2","y2","points","get","length","drawPolygon","random","floor","Date","getTime","Circle","radius","stroke","strokeWidth","layerX","getZoom","layerY","hasBorders","hasControls","objectCaching","line","Line","evented","pos","push","Polygon","remove","polyPoint","each","index","point","i","behaviors","value","label","posture","status","columns","remove_table_index","dataField","text","headerStyle","editCellStyle","cell","row","rowIndex","colIndex","backgroundColor","editor","type","Type","SELECT","editable","formatter","cellContent","Button","className","onClick","Instructions","ANNOTATION_VIDEO_NAME","ANNOTATOR_NAME","VIDEO_METADATA","a","fileName","split","slice","join","json","JSON","stringify","blob","Blob","URL","createObjectURL","href","link","document","createElement","download","body","appendChild","click","removeChild","convert_data_csv","data","csv","j","vals","Object","keys","map","key","CustomNavBar","props","useState","show","setShow","handleClose","uploadShow","setUploadShow","handleUploadClose","Modal","onHide","size","Header","closeButton","Title","Body","Footer","variant","style","display","float","gridColumn","gridRow","defaultValue","onChange","event","change_annotator_name","NavDropdown","Divider","Form","File","accept","custom","handleVideoUpload","disabled","disable_buttons","handleOldAnnotation","change_skip_value","parseInt","video_width","video_height","Navbar","bg","Brand","Nav","title","Item","downloadFileJSON","downloadFileCSV","handle_link_open","Dropdown","as","ButtonGroup","display_frame_num","Toggle","Menu","skip_frame_backward","handlePlaying","play_button_text","skip_frame_forward","drop","addToCanvas","change_annotation_type","FabricRender","el","ReactDOM","findDOMNode","fabricCanvas","initialize","scaling_factor_height","scaling_factor_width","save_data","currentFrame","React","Component","Storage","alert","num_frames","skip_value","window","screen","current_screen_height","Canvas","upload","sliderPercent","toast_text","previous_annotation","previous_canvas_annotation","frame_num","MainUpload","setVisualToggle","annotationType","setAnnotationType","boxCount","setBoxCount","videoFilePath","setVideoFileURL","oldAnnotation","setOldAnnotation","player","setPlayer","duration","setDuration","save","changeSave","setSeeking","playing","setPlaying","setCurrentFrame","save_previous_data","annotation_type_txt","new_bbox","generate_no_behavior","generate_polygon","global_id","current","fire","useEffect","get_frame_data","get_annotation_data","handle_visual_toggle","downloadOldAnnotation","file","Promise","resolve","reject","reader","FileReader","onload","parse","result","readAsText","files","scrubbing","setScrubbing","total_frames","seekTo","getCurrentTime","keyCheck","changeKeyCheck","onKeyPress","annotext","addEventListener","removeEventListener","loadFromJSON","open","then","Toast","onClose","delay","autohide","position","zIndex","onProgress","val","frame_calc","round","ref","videoWidth","videoHeight","name","horizontal_res","vertical_res","frame_rate","onDuration","url","controls","volume","muted","pip","playbackRate","min","max","step","onMouseDown","parseFloat","onMouseUp","Tabs","defaultActiveKey","Tab","eventKey","keyField","index_num","substring","getObjects","splice","table","noDataIndication","cellEdit","cellEditFactory","mode","blurToSave","afterSaveCell","oldValue","newValue","column","onStartEdit","columnIndex","pagination","paginationFactory","MainYoutube","visualToggle","downloadFile","ChangeTable","current_screen_width","MainMultiview","CHECKBOX","videoFilePath1","setVideoFileURL1","handleSetPlayer","handleSetDuration","handleSetCurrentFrame","Link","SelectionScreen","youtube","setYoutube","setUpload","multiview","setMultiview","Jumbotron","fluid","Container","src","process","alt","App","Boolean","location","hostname","match","render","getElementById","navigator","serviceWorker","ready","registration","unregister","catch","error","message"],"mappings":"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","file":"static/js/main.af5f7374.chunk.js","sourcesContent":["export default class ExtractingAnnotation{\n    constructor(annotation_json){\n        this.frame_data = annotation_json['annotations']\n        this.annotation_data = annotation_json['behavior_data']\n    }\n\n    get_frame_data(){\n        return this.frame_data\n    }\n    \n    get_annotation_data(){\n        return this.annotation_data\n    }\n}\n\n\n//This is the parser for the Multi-Camera pig tracking output JSON code. \nclass MCPT_Processing {\n    constructor(annotation_json){\n        this.objects = annotation_json['objects']\n        console.log(this.objects)\n    }\n\n    getObjects_MCPT() {\n        return this.objects\n    }\n\n    getObjectById_MCPT(id) {\n        return this.objects[id]\n    }\n    \n    getObjectByIdFrame(id, frame_num){\n        return this.objects[id][frame_num]\n    }\n\n    getAllObjectByFrame_MCPT(frame_num){\n        var i;\n        var objects_frame = []\n        for (i = 0; i < this.objects.length; i++){\n            var curr_obj = this.objects[i]\n            if(curr_obj['frames'][curr_obj['frames'].length-1]['frameNumber'] < frame_num){\n                continue;\n            }\n            var curr_obj_frames = curr_obj['frames'];\n            for (var j = 0; j < curr_obj_frames.length; j++){\n                if(curr_obj_frames[j]['frameNumber'] === frame_num){\n                    objects_frame.push(curr_obj_frames[j]);\n                    break;\n                }\n            }\n        }\n        console.log(objects_frame)\n        return objects_frame;\n    }\n}","import { grep } from \"jquery\";\n\nconst fabric = require(\"fabric\").fabric;\n\nclass BoundingBox {\n    constructor(top, left, width, height, color, id, behavior) {\n        this.top = top;\n        this.left = left;\n        this.id = id;\n        this.behavior = behavior;\n        this.color = color;\n        this.width = width;\n        this.height = height;\n    }\n\n    rectangle(){\n        return new fabric.Rect({\n            hasRotatingPoint: false,\n            uniScaleTransform: true,\n            height: this.height,\n            width: this.width,\n            fill: this.color,\n            borderColor: '#000',\n            opacity: '.4',\n            top: this.top,\n            left: this.left,\n        });\n    } \n\n    //TODO Add text scaling\n    id_text(){\n        return new fabric.Text(this.id.toString(), {\n            fontSize: 20,\n            top: this.top,\n            left: this.left,\n            uniScaleTransform: false,\n          });\n    }\n\n    behavior(){\n\n    }\n\n    generate_no_behavior(canvas){\n        var group = new fabric.Group();\n        group.addWithUpdate(this.rectangle())\n        group.addWithUpdate(this.id_text())\n        \n        var temp = this.id \n        group.toObject = (function(toObject) {\n            return function(propertiesToInclude) {\n                return fabric.util.object.extend(toObject.call(this, propertiesToInclude), {\n                    local_id: temp\n                });\n            };\n        })(group.toObject);\n        console.log(group.toJSON())\n\n        //canvas.add(group)\n\n        function onChange(obj) {\n            var circle = obj.target.item(1),\n                group = obj.target,\n                scaleX = group.width / (group.width * group.scaleX),\n                scaleY = group.height / (group.height * group.scaleY);\n            circle.set('scaleX', scaleX);\n            circle.set('scaleY', scaleY);\n        }\n        canvas.on({\n            'object:scaling': onChange\n        })\n        return group\n    }\n\n    generate_mouse_no_behavior(canvas){\n        var group, isDown, origX, origY;\n\n        var temp_id = new fabric.Text(this.id.toString(), {\n            fontSize: 20,\n            top: this.top,\n            left: this.left,\n            uniScaleTransform: false,\n          });\n\n        canvas.on('mouse:down', function(o){\n            isDown = true;\n            var pointer = canvas.getPointer(o.e);\n            origX = pointer.x;\n            origY = pointer.y;\n            var pointer = canvas.getPointer(o.e);\n            var rect_temp = new fabric.Rect({\n                left: origX,\n                top: origY,\n                originX: 'left',\n                originY: 'top',\n                width: pointer.x-origX,\n                height: pointer.y-origY,\n                angle: 0,\n                fill: 'rgba(255,0,0,0.5)',\n                transparentCorners: false,\n                uniScaleTransform: true\n            });\n            group = rect_temp\n\n\n            canvas.add(group)\n        });\n        \n        canvas.on('mouse:move', function(o){\n            if (!isDown) return;\n            var pointer = canvas.getPointer(o.e);\n            \n            if(origX>pointer.x){\n                group.set({ left: Math.abs(pointer.x) });\n            }\n            if(origY>pointer.y){\n                group.set({ top: Math.abs(pointer.y) });\n            }\n            \n            group.set({ width: Math.abs(origX - pointer.x) });\n            group.set({ height: Math.abs(origY - pointer.y) });\n            \n            \n            canvas.renderAll();\n        });\n        \n        canvas.on('mouse:up', function(o){\n          isDown = false;\n          canvas.off('mouse:down')\n          canvas.off('mouse:up')\n        });\n    }\n\n    generate_with_behavior(){\n\n    }\n}\n\n\nfunction genetate_bounding_box(){\n\n}\n\nexport {BoundingBox, genetate_bounding_box}","const fabric = require(\"fabric\").fabric;\n\nclass KeyPoint {\n    //TODO Optimize this code. Right now there is a significant performance penalty if there are multiple keypoints on the canvas\n    generate_stick(canvas){\n        fabric.Object.prototype.originX = fabric.Object.prototype.originY = 'center';\n\n        function makeCircle(left, top, line1, line2, line3, line4) {\n            var c = new fabric.Circle({\n            left: left,\n            top: top,\n            strokeWidth: 2.5,\n            radius: 6,\n            fill: '#fff',\n            stroke: '#666'\n            });\n            c.hasControls = c.hasBorders = false;\n\n            c.line1 = line1;\n            c.line2 = line2;\n            c.line3 = line3;\n            c.line4 = line4;\n\n            return c;\n        }\n\n        function makeLine(coords) {\n            return new fabric.Line(coords, {\n            fill: 'red',\n            stroke: 'red',\n            strokeWidth: 5,\n            selectable: true,\n            evented: false,\n            });\n        }\n\n        var line = makeLine([ 250, 200, 250, 175 ]),\n            line2 = makeLine([ 250, 175, 250, 250 ]),\n            line3 = makeLine([ 250, 250, 300, 350]),\n            line4 = makeLine([ 250, 250, 200, 350]),\n            line5 = makeLine([ 250, 175, 175, 225 ]),\n            line6 = makeLine([ 250, 175, 325, 225 ]);\n\n        canvas.add(line, line2, line3, line4, line5, line6);\n\n        canvas.add(\n            makeCircle(line.get('x1'), line.get('y1'), null, line),\n            makeCircle(line.get('x2'), line.get('y2'), line, line2, line5, line6),\n            makeCircle(line2.get('x2'), line2.get('y2'), line2, line3, line4),\n            makeCircle(line3.get('x2'), line3.get('y2'), line3),\n            makeCircle(line4.get('x2'), line4.get('y2'), line4),\n            makeCircle(line5.get('x2'), line5.get('y2'), line5),\n            makeCircle(line6.get('x2'), line6.get('y2'), line6)\n        );\n\n        canvas.on('object:moving', function(e) {\n            var p = e.target;\n            p.line1 && p.line1.set({ 'x2': p.left, 'y2': p.top });\n            p.line2 && p.line2.set({ 'x1': p.left, 'y1': p.top });\n            p.line3 && p.line3.set({ 'x1': p.left, 'y1': p.top });\n            p.line4 && p.line4.set({ 'x1': p.left, 'y1': p.top });\n            canvas.renderAll();\n        });\n    }   \n\n\n    generate_poly(canvas){\n        \n    }\n}\n\nexport {KeyPoint}","const fabric = require(\"fabric\").fabric;\nconst $ = require(\"jquery\")\n\nclass Segmentation {\n    generate_polygon(canvas, id){\n        var min = 99;\n        var max = 999999;\n        var polygonMode = true;\n        var pointArray = new Array();\n        var lineArray = new Array();\n\n        var activeLine;\n        var activeShape = false;\n\n        canvas.forEachObject(function(object){ \n            object.selectable = false; \n        });\n\n        var prototypefabric = new function () {\n                //canvas = window._canvas = new fabric.Canvas('c');\n                //canvas.setWidth($(window).width());\n                //canvas.setHeight($(window).height()-$('#nav-bar').height());\n                canvas.selection = false;\n        \n                canvas.on('mouse:down', function (options) {\n                    if(options.target && options.target.id === pointArray[0].id){\n                        prototypefabric.polygon.generatePolygon(pointArray);\n                    }\n                    if(polygonMode){\n                        prototypefabric.polygon.addPoint(options);\n                    }\n                });\n                canvas.on('mouse:up', function (options) {\n        \n                });\n                canvas.on('mouse:move', function (options) {\n                    if(activeLine && activeLine.class == \"line\"){\n                        var pointer = canvas.getPointer(options.e);\n                        activeLine.set({ x2: pointer.x, y2: pointer.y });\n        \n                        var points = activeShape.get(\"points\");\n                        points[pointArray.length] = {\n                            x:pointer.x,\n                            y:pointer.y\n                        }\n                        activeShape.set({\n                            points: points\n                        });\n                        canvas.renderAll();\n                    }\n                    canvas.renderAll();\n                });\n        }();\n        \n        \n        \n        prototypefabric.polygon = {\n            drawPolygon : function() {\n                polygonMode = true;\n                pointArray = new Array();\n                lineArray = new Array();\n            },\n            addPoint : function(options) {\n                var random = Math.floor(Math.random() * (max - min + 1)) + min;\n                var id = new Date().getTime() + random;\n                var circle = new fabric.Circle({\n                    radius: 5,\n                    fill: '#ffffff',\n                    stroke: '#333333',\n                    strokeWidth: 0.5,\n                    left: (options.e.layerX/canvas.getZoom()),\n                    top: (options.e.layerY/canvas.getZoom()),\n                    selectable: false,\n                    hasBorders: false,\n                    hasControls: false,\n                    originX:'center',\n                    originY:'center',\n                    id:id,\n                        objectCaching:false\n                });\n                if(pointArray.length === 0){\n                    circle.set({\n                        fill:'red'\n                    })\n                }\n                var points = [(options.e.layerX/canvas.getZoom()),(options.e.layerY/canvas.getZoom()),(options.e.layerX/canvas.getZoom()),(options.e.layerY/canvas.getZoom())];\n                var line = new fabric.Line(points, {\n                    strokeWidth: 2,\n                    fill: '#999999',\n                    stroke: '#999999',\n                    class:'line',\n                    originX:'center',\n                    originY:'center',\n                    selectable: false,\n                    hasBorders: false,\n                    hasControls: false,\n                    evented: false,\n                        objectCaching:false\n                });\n                if(activeShape){\n                    var pos = canvas.getPointer(options.e);\n                    var points = activeShape.get(\"points\");\n                    points.push({\n                        x: pos.x,\n                        y: pos.y\n                    });\n                    var polygon = new fabric.Polygon(points,{\n                        stroke:'#333333',\n                        strokeWidth:1,\n                        fill: '#cccccc',\n                        opacity: 0.3,\n                        selectable: false,\n                        hasBorders: false,\n                        hasControls: false,\n                        evented: false,\n                        objectCaching:false\n                    });\n                    canvas.remove(activeShape);\n                    canvas.add(polygon);\n                    activeShape = polygon;\n                    canvas.renderAll();\n                }\n                else{\n                    var polyPoint = [{x:(options.e.layerX/canvas.getZoom()),y:(options.e.layerY/canvas.getZoom())}];\n                    var polygon = new fabric.Polygon(polyPoint,{\n                        stroke:'#333333',\n                        strokeWidth:1,\n                        fill: '#cccccc',\n                        opacity: 0.3,\n                        selectable: false,\n                        hasBorders: false,\n                        hasControls: false,\n                        evented: false,\n                        objectCaching:false\n                    });\n                    activeShape = polygon;\n                    canvas.add(polygon);\n                }\n                activeLine = line;\n        \n                pointArray.push(circle);\n                lineArray.push(line);\n        \n                canvas.add(line);\n                canvas.add(circle);\n                canvas.selection = false;\n            },\n            generatePolygon : function(pointArray){\n                var points = new Array();\n                $.each(pointArray,function(index,point){\n                    points.push({\n                        x:point.left,\n                        y:point.top\n                    });\n                    canvas.remove(point);\n                });\n                $.each(lineArray,function(index,line){\n                    canvas.remove(line);\n                });\n\n                console.log(pointArray)\n                console.log(lineArray)\n\n\n                var group = new fabric.Group()\n                for (var i = 0; i < pointArray.length; i++){\n                    group.addWithUpdate(pointArray[i])\n                    group.addWithUpdate(lineArray[i])\n                }\n                \n                /*group.addWithUpdate(new fabric.Text(id.toString(), {\n                    fontSize: 20,\n                    centerX: \"center\",\n                    top: pointArray[0].top,\n                    left: pointArray[0].left, \n                    uniScaleTransform: false,\n                  }));\n                */\n               //To add custom id\n                group.toObject = (function(toObject) {\n                    return function(propertiesToInclude) {\n                        return fabric.util.object.extend(toObject.call(this, propertiesToInclude), {\n                            local_id: id\n                        });\n                    };\n                })(group.toObject);\n\n                canvas.add(group)\n                  \n                canvas.remove(activeLine);\n                canvas.remove(activeShape)\n                //canvas.add(polygon);\n        \n                activeLine = null;\n                activeShape = null;\n                polygonMode = false;\n                canvas.selection = true;\n\n                canvas.forEachObject(function(object){ \n                    object.selectable = true; \n                });\n\n                return group\n            }\n        };\n        \n        \n        //return prototypefabric.polygon.drawPolygon();\n    }\n}\n\nexport {Segmentation}","const behaviors = [{\n  value: 'inactive',\n  label: 'Inactive'\n},{\n  value: 'walking',\n  label: 'Walking'\n},{\n  value: 'running',\n  label: 'Running'\n},{\n  value: 'play_solo',\n  label: 'Play Solo'\n},{\n  value: 'play_social',\n  label: 'Play Social'\n},{\n  value: 'head_tossing',\n  label: 'Head Tossing'\n},{\n  value: 'interacting',\n  label: 'Interacting with pen features'\n},{\n  value: 'drinking',\n  label: 'Drinking'\n},{\n  value: 'eating',\n  label: 'Eating'\n},{\n  value: 'fighting',\n  label: 'Fighting'\n},{\n  value: 'defacating',\n  label: 'Defacating'\n},{\n  value: 'other_active',\n  label: 'Other'\n},{\n  value: 'unknown',\n  label: 'Unknown'\n},]\n\nexport {behaviors};","const posture = [{\n    value: 'Lying sternally',\n    label: 'lying_sternally'\n  }, {\n    value: 'Sitting',\n    label: 'sitting'\n  }, {\n    value: 'Standing',\n    label: 'standing'\n  }, {\n    value: 'Walking ',\n    label: 'walking'\n  }, {\n    value: 'Consumption',\n    label: 'consumption'\n  }]\n\n  export {posture}","const status = [{\n    value: 'Stationary',\n    label: 'Stationary'\n},{\n    value: 'Minor',\n    label: 'Minor'\n},{\n    value: 'Stationary Transition',\n    label: 'Stationary Transition'\n},{\n    value: 'Active Transition',\n    label: 'Active Transition'\n},{\n    value: 'Active',\n    label: 'Active'\n},{\n    value: 'Event',\n    label: 'Event'\n}]\n\nexport {status}","import React from \"react\"; \nimport { Type } from 'react-bootstrap-table2-editor';\nimport {behaviors} from './behaviors'\nimport {posture} from './posture'\nimport {status} from './status'\nimport Button from 'react-bootstrap/Button'\n\nconst columns = (remove_table_index) => [{\n  dataField: \"id\",\n  text: \"ID\",\n  headerStyle: () => { return { width: \"40px\", left: 0 }; }\n},{\n  dataField: \"global_id\",\n  text: \"Glo\",\n  headerStyle: () => { return { width: \"50px\", left: 0}; },\n  editCellStyle: (cell, row, rowIndex, colIndex) => {\n    const backgroundColor = cell > 2101 ? '#00BFFF' : '#00FFFF';\n    return { backgroundColor };\n  }\n},{\n  dataField: \"status\",\n  text: \"Status\",\n  editor: {\n      type: Type.SELECT,\n      options: status\n    }\n},{\n  dataField: \"behavior\",\n  text: \"Behavior\",\n  editor: {\n      type: Type.SELECT,\n      options: behaviors,\n  }\n},\n{\n  dataField: \"posture\",\n  text: \"Posture\",\n  editor: {\n      type: Type.SELECT,\n      options: posture,\n  }\n},{\n  dataField: \"remove\",\n  text: \"Del\",\n  editable: false,\n  headerStyle: () => { return { width: \"50px\", left: 0}; },\n  formatter: (cellContent, row) => {\n    return (\n      <Button\n        className=\"btn btn-danger btn-xs\"\n          onClick={() => remove_table_index(row.id)}\n          label=\"Del\"\n        >\n      </Button>\n    );\n  },\n}\n]\nexport {columns}","import React, { useState } from \"react\"; \n\nexport default function Instructions(){\n    return (\n        <div>\n        <h3>Keybinds:</h3>\n\n        There are preset keybinds setup to make it easier to use the tool without having to click around. If done properly a combination of mouse and keyboard actions speed up the annotation process. \n        <br></br><br></br>\n        * <kbd>1</kbd> : Mode Switch: Bounding Box<br></br>\n        * <kbd>2</kbd> : Mode Switch: Key Point<br></br>\n        * <kbd>3</kbd> : Mode Switch: Segmentation<br></br>\n        * <kbd>a</kbd> : Add annotation<br></br>\n        * <kbd>r</kbd> : Remove selected annotation<br></br>\n        * <kbd>q</kbd> : Skip backward frame(s)<br></br>\n        * <kbd>s</kbd> : Save annotation<br></br>\n        * <kbd>w</kbd> : Pause/Play<br></br>\n        * <kbd>e</kbd> : Skip forward frame(s)<br></br>\n        * <kbd>c</kbd> : Copy previous annotation<br></br>\n        * <kbd>f</kbd> : Activate/Deactivate scrub mode (Activated by default)<br></br>\n\n        <br></br><br></br>\n        <h3>Uploading Video:</h3>\n\n        Ensure that you know the framerate, vertical and horizontal resolution of the video chosen to be annotated. These values should be entered into the settings tab into their respective fields. \n        <br></br><br></br>\n        Click on the right side browse button. All other buttons on the screen shuold be disabled until the video has been uploaded. Currenntly ```.mp4``` format is the best choice and tested for. \n        <br></br><br></br>\n        <h3>Annotations</h3>\n        <br></br>\n        There are currently three kinds of annotations. \n        <br></br><br></br>\n        <h4>Bounding Box:</h4>\n\n        This forms a square around the desired object. There should be small squares at the edges of the bounding box which can be used to resize the box. The number on the top left of the box is used to identify the placement of the box in the table to the right.\n        <br></br><br></br>\n        <h4>Key Point:</h4>\n\n        This generates an object with multiple points and lines attached to each other. They should be arranged around the obejct where the singular circle with one connecting line is the head and progress to each of the other limbs. \n\n        ***Note: This feature is currently in development and there will be bugs in using this.***\n        <br></br><br></br>\n        <h4>Segmentation:</h4>\n\n        Upon generating this each click on the video generates a point which eventually will transform to a set of interconnected points. To complete the polygon click on the original point generated (which is the red colored point)\n\n        ***Note: Unline the Bounding Box, segmentation cant be edited after generated. To fix a mistake remove the annotation and continue from the start.***\n\n        </div>\n    )\n}","import { cssNumber } from \"jquery\";\n\nexport async function downloadFileJSON (ANNOTATION_VIDEO_NAME, ANNOTATOR_NAME, frame_data, annotation_data, VIDEO_METADATA) {\n    var fileName = \"generated_annotations\";\n    if(ANNOTATION_VIDEO_NAME !== \"\" && ANNOTATOR_NAME !== \"\"){\n        fileName = ANNOTATION_VIDEO_NAME.split('.').slice(0, -1).join('.') + \"_\" +  ANNOTATOR_NAME\n    }\n    console.log(annotation_data)\n    //const json = JSON.stringify(fabricCanvas.getObjects());\n    const json = JSON.stringify({\"vid_metadata\": VIDEO_METADATA, \"annotations\": frame_data, \"behavior_data\": annotation_data})\n    //var json = JSON.stringify(frame_data);\n    var blob = new Blob([json],{type:'application/json'});\n    var href = await URL.createObjectURL(blob);\n    var link = document.createElement('a');\n    link.href = href;\n    link.download = fileName + \".json\";\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n}\n\nfunction convert_data_csv(data, columns){\n    console.log(columns)\n    var csv = new Array(data.length + 1)\n    for(var i = 0; i < csv.length; i++){\n        csv[i] = []\n    }\n    csv[0].push(\"frame_num\")\n    for(var i = 0; i < columns.length; i++){\n        csv[0].push(columns[i]['dataField'])\n    }\n    for(var i = 0; i < data.length; i++){\n        for(var j = 0; j < data[i].length; j++){\n            csv[i+1][j]=[];\n            var obj = data[i][j]\n            var vals = Object.keys((obj)).map(function (key) { return obj[key]; });\n            csv[i+1][j] = i + \",\" + vals.join(\",\")\n        }\n        csv[i+1] = csv[i+1].join(\"\\n\")\n    }\n    csv = csv.join(\"\\n\")\n    return csv\n}\n\nexport async function downloadFileCSV (ANNOTATION_VIDEO_NAME, ANNOTATOR_NAME, annotation_data, columns) {\n    var fileName = \"generated_annotations\";\n    if(ANNOTATION_VIDEO_NAME !== \"\" && ANNOTATOR_NAME !== \"\"){\n        fileName = ANNOTATION_VIDEO_NAME.split('.').slice(0, -1).join('.') + \"_\" +  ANNOTATOR_NAME\n    }\n    var csv = convert_data_csv(annotation_data, columns(\"\"))\n    var blob = new Blob([csv],{type:'application/octet-stream'});\n    var href = await URL.createObjectURL(blob);\n    var link = document.createElement('a');\n    link.href = href;\n    link.download = fileName + \".csv\";\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n}","import React from 'react';\nimport { useState } from 'react';\nimport \"bootstrap/dist/css/bootstrap.min.css\";\n\nimport Navbar from 'react-bootstrap/Navbar'\nimport Nav from 'react-bootstrap/Nav'\nimport Button from 'react-bootstrap/Button'\nimport { NavDropdown } from 'react-bootstrap';\nimport Form from 'react-bootstrap/Form'\nimport Dropdown from 'react-bootstrap/Dropdown'\nimport { ButtonGroup } from 'react-bootstrap';\nimport Modal from 'react-bootstrap/Modal'\nimport { InputGroup } from 'react-bootstrap';\nimport { FormControl } from 'react-bootstrap';\n\nimport Instructions from './instructions';\nimport { downloadFileJSON , downloadFileCSV} from '../../processing/misc';\n\nexport default function CustomNavBar(props){\n\tconst [show, setShow] = useState(false);\n\tconst handleClose = () => setShow(false);\n\tconst handleShow = () => setShow(true);\n\n\tconst [uploadShow, setUploadShow] = useState(false);\n\tconst handleUploadClose = () => setUploadShow(false)\n\tconst handleUploadShow = () => setUploadShow(true)\n\n\tconst handleDownloadJSON = () => {\n\t\tdownloadFileJSON(props.ANNOTATION_VIDEO_NAME, props.ANNOTATOR_NAME, props.frame_data, props.annotation_data, props.VIDEO_METADATA)\n\t}\n\n\tconst handleDownloadCSV = () => {\n\t\tdownloadFileCSV(props.ANNOTATION_VIDEO_NAME, props.ANNOTATOR_NAME, props.annotation_data, props.columns)\n\t}\n\n\treturn (\n\t\t<div>\n\t\t<Modal show={show} onHide={handleClose} size='lg'>\n\t\t\t<Modal.Header closeButton>\n\t\t\t<Modal.Title>Instructions</Modal.Title>\n\t\t\t</Modal.Header>\n\t\t\t<Modal.Body><Instructions></Instructions></Modal.Body>\n\t\t\t<Modal.Footer>\n\t\t\t<Button variant=\"secondary\" onClick={handleClose}>Close</Button>\n\t\t\t</Modal.Footer>\n\t\t</Modal>\n\t\t<Modal show={uploadShow} onHide={handleUploadClose} size='lg'>\n\t\t\t<Modal.Header closeButton>\n\t\t\t<Modal.Title>Upload</Modal.Title>\n\t\t\t</Modal.Header>\n\t\t\t<Modal.Body>\n\t\t\t\t<div style={{display: \"grid\"}}>\n\t\t\t\t\t<div style={{float: \"left\",gridColumn: 1, gridRow:1}}>Annotator Name: <input type='text' defaultValue={props.ANNOTATOR_NAME} onChange={(event) => {props.change_annotator_name(event.target.value)}}></input><NavDropdown.Divider /></div>\n\t\t\t\t\t\n\t\t\t\t\t<Form style={{float: \"left\",gridColumn: 1, gridRow:2}}>\n\t\t\t\t\t\t<Form.File id=\"file\" label=\"Video Upload\" accept=\".mp4\" custom type=\"file\" onChange={props.handleVideoUpload} />\n\t\t\t\t\t</Form>\n\t\t\t\t\t<Form style={{float: \"left\",gridColumn: 1, gridRow:3}}>\n\t\t\t\t\t\t<Form.File disabled={props.disable_buttons} accept=\".json\" id=\"file\" label=\"Annotation Upload\" custom type=\"file\" onChange={props.handleOldAnnotation}/>\n\t\t\t\t\t</Form>\n\t\t\t\t\t\t<NavDropdown.Divider />\n\t\t\t\t\t\tFrame Rate: <input type=\"number\" defaultValue=\"15\"></input>\n\t\t\t\t\t\t<NavDropdown.Divider />\n\t\t\t\t\t\tSkip Value: <input type='number' defaultValue=\"1\" onChange={(event) => {props.change_skip_value(parseInt(event.target.value))}}></input>\n\t\t\t\t\t\t<NavDropdown.Divider />\n\t\t\t\t\t\tHorizontal Res: <input type='number' defaultValue={props.video_width}></input>\n\t\t\t\t\t\tVertical Res: <input type='number' defaultValue={props.video_height}></input>\n\t\t\t\t\t\t<NavDropdown.Divider />\n\t\t\t\t\t\t\n\t\t\t\t</div>\n\t\t\t</Modal.Body>\n\t\t\t<Modal.Footer>\n\t\t\t<Button variant=\"secondary\" onClick={handleUploadClose}>Close</Button>\n\t\t\t</Modal.Footer>\n\t\t</Modal>\n\t\t<Navbar bg=\"dark\" variant=\"dark\" className=\"bg-5\">\n\t\t\t\t<Navbar.Brand href=\"#home\">Annotation Tool</Navbar.Brand>\n\t\t\t\t<Nav className=\"mr-auto\">\n\t\t\t\t\t\t<NavDropdown disabled={props.disable_buttons} title=\"Export\" id=\"basic-nav-dropdown\">\n\t\t\t\t\t\t\t<NavDropdown.Item onClick={handleDownloadJSON}>JSON</NavDropdown.Item>\n\t\t\t\t\t\t\t<NavDropdown.Divider />\n\t\t\t\t\t\t\t<NavDropdown.Item onClick={handleDownloadCSV}>CSV</NavDropdown.Item>\n\t\t\t\t\t\t</NavDropdown>\n\t\t\t\t\t\t<NavDropdown title=\"Help\" id=\"basic-nav-dropdown\">\n\t\t\t\t\t\t\t<NavDropdown.Item onClick={props.handle_link_open}>Report</NavDropdown.Item>\n\t\t\t\t\t\t\t<NavDropdown.Divider />\n\t\t\t\t\t\t\t<NavDropdown.Item onClick={handleShow}>Instructions</NavDropdown.Item>\n\t\t\t\t\t\t</NavDropdown>\n\t\t\t\t</Nav>\n\t\t\t\t<div>\n\n\t\t\t\t\t<Button variant=\"outline-success\" onClick={handleUploadShow}>Upload</Button>{' '}\n\t\t\t\t\t<Dropdown as={ButtonGroup}>\n\t\t\t\t\t\t<Button variant=\"secondary\" disabled={true}>{props.display_frame_num}</Button>{' '}\n\t\t\t\t\t\t<Dropdown.Toggle split variant=\"secondary\" id=\"dropdown-split-basic\" />\n\t\t\t\t\t\t<Dropdown.Menu>\n\t\t\t\t\t\t\tSkip Value: <input type='number' defaultValue=\"1\" onChange={(event) => {props.change_skip_value(parseInt(event.target.value))}}></input>\n\t\t\t\t\t\t</Dropdown.Menu>\n\t\t\t\t\t</Dropdown>{' '}\n\t\t\t\t\t\n\t\t\t\t\t<Button variant=\"primary\" disabled={props.disable_buttons} onClick={props.skip_frame_backward}>Prev</Button>{' '}\n\t\t\t\t\t<Button variant=\"primary\" disabled={props.disable_buttons} onClick={props.handlePlaying}>{props.play_button_text}</Button>{' '}\n\t\t\t\t\t<Button variant=\"primary\" disabled={props.disable_buttons} onClick={props.skip_frame_forward}>Next</Button>{' '}\n\t\t\t\t\t<Dropdown as={ButtonGroup} drop='left'>\n\t\t\t\t\t\t<Button variant=\"success\" onClick={props.addToCanvas}>Add</Button>\n\t\t\t\t\t\t<Dropdown.Toggle split variant=\"success\" id=\"dropdown-split-basic\" />\n\t\t\t\t\t\t<Dropdown.Menu>\n\t\t\t\t\t\t\t<Dropdown.Item onClick={(event) =>{props.change_annotation_type(\"1\")}}>Behavior Annotation</Dropdown.Item>\n\t\t\t\t\t\t\t<Dropdown.Item onClick={(event) =>{props.change_annotation_type(\"2\")}}>BoundingBox</Dropdown.Item>\n\t\t\t\t\t\t\t<Dropdown.Item onClick={(event) =>{props.change_annotation_type(\"3\")}}>KeyPoint</Dropdown.Item>\n\t\t\t\t\t\t\t<Dropdown.Item onClick={(event) =>{props.change_annotation_type(\"4\")}}>Segmentation</Dropdown.Item>\n\t\t\t\t\t\t</Dropdown.Menu>\n\t\t\t\t\t</Dropdown>\n\t\t\t\t\t{/*<Button variant=\"danger\" onClick={remove} disabled={disable_buttons} style={{position:\"relative\"}}>Remove</Button>{' '}*/}\n\t\t\t\t</div>\n\t\t</Navbar>\n\t\t</div>\n\t)\n}","import React from 'react';\nimport ReactDOM from 'react-dom'\nimport { useState } from 'react';\n\nexport default class FabricRender extends React.Component{\n    componentDidMount() {\n        var el = ReactDOM.findDOMNode(this);\n  \n      //alert(\"Loaded player: \\nHorizontal Resolution = \" + scaling_factor_width + \"\\nVertical Resolution = \" + scaling_factor_height)\n      // Here we have the canvas so we can initialize fabric\n      this.props.fabricCanvas.initialize(el, {\n          height: this.props.scaling_factor_height,\n        width: this.props.scaling_factor_width,\n        backgroundColor : null,\n      });\n      \n      // on mouse up lets save some state\n      this.props.fabricCanvas.on('mouse:up', () => {\n        this.props.save_data(this.props.currentFrame)\n      });\n  \n      this.props.fabricCanvas.on('object:added', this.props.save_data(this.props.currentFrame));\n      this.props.fabricCanvas.on('object:removed', this.props.save_data(this.props.currentFrame));\n      this.props.fabricCanvas.on('object:modified', this.props.save_data(this.props.currentFrame));\n      \n      // an event we will fire when we want to save state\n      this.props.fabricCanvas.on('saveData', () => {\n        this.props.fabricCanvas.renderAll(); // programatic changes we make will not trigger a render in fabric\n      });\n    }\n\n    render() {\n      return <canvas></canvas>\n    }\n}","//Core imports\nimport React, { useEffect, useState } from \"react\"; \nimport ReactDOM from 'react-dom'\nimport ReactPlayer from 'react-player'\nimport 'bootstrap/dist/css/bootstrap.min.css';\n\n//UI Element imports\nimport Button from 'react-bootstrap/Button'\nimport Modal from 'react-bootstrap/Modal'\nimport Toast from 'react-bootstrap/Toast'\nimport Tabs from 'react-bootstrap/Tabs'\nimport Tab from 'react-bootstrap/Tab'\n\n//Processing\nimport ExtractingAnnotation from '../../processing/annotation-processing'\n\n//Annotations\nimport { BoundingBox } from '../../annotations/bounding_box'\nimport { KeyPoint } from '../../annotations/key_point'\nimport { Segmentation } from '../../annotations/segmentation'\n\n//Table imports\nimport BootstrapTable from 'react-bootstrap-table-next';\nimport cellEditFactory from 'react-bootstrap-table2-editor';\nimport 'react-bootstrap-table-next/dist/react-bootstrap-table2.min.css';\nimport paginationFactory from 'react-bootstrap-table2-paginator';\n\n//Column information + data structure\nimport {columns} from '../../static_data/columns'\n//import {columns_LPS} from '../../static_data/columns'\nimport {ANNOTATION_FRAME, ANNOTATION_BBOX, ANNOTATION_KEYPOINT, ANNOTATION_SEG} from '../../static_data/constants'\n\n//Components\nimport Instructions from \"../Components/instructions\";\nimport CustomNavBar from \"../Components/nav_bar\";\nimport FabricRender from \"../Components/fabric_canvas\";\n\n//TODO add local storage functionality to auto-save\nif (typeof(Storage) === \"undefined\") {\n  // Code for localStorage/sessionStorage.\n  alert('Your browser does not support local storage. \\nSome autosaving features of the app will not work as intended.\\nPlease see the documentation to find supported browsers and their versions')\n}\n\nconst fabric = require(\"fabric\").fabric;\nconst createReactClass = require('create-react-class');\n\n\n\n//TODO ADD DYNAMIC SOLUTION \nvar frame_rate = 15;\nvar num_frames = -1;\nvar scaling_factor_width = 1920;\nvar scaling_factor_height = 1080;\nvar skip_value = 1;\n\nconsole.log(window.screen.width)\nconsole.log(window.screen.height)\n\nvar current_screen_width = window.screen.width;\nvar current_screen_height = window.screen.height;\n\n//Mappings are based off of https://en.wikipedia.org/wiki/List_of_common_resolutions make sure to use 1:1 and 16:9 aspect ratio\nif (current_screen_height >= 1440){\n  scaling_factor_width = 1920;\n  scaling_factor_height = 1080;\n}else if(current_screen_height >= 1080){\n  scaling_factor_width = 1280;\n  scaling_factor_height = 720;\n}else if(current_screen_height >= 1024){\n  scaling_factor_width = 1152;\n  scaling_factor_height = 648;\n}else if(current_screen_height >= 768){\n  scaling_factor_width = 1024;\n  scaling_factor_height = 576;\n}\n\n// globally accessable fabricCanvas instance\nvar fabricCanvas = new fabric.Canvas('c', {uniScaleTransform: true});\n\nvar video_width = 0;\nvar video_height = 0;\nvar frame_data = [[]];\nvar annotation_data = [[]];\nvar upload = false;\nvar disable_buttons = true;\nvar sliderPercent = 0\nvar toast_text = \"\"\nvar previous_annotation = []\nvar previous_canvas_annotation = []\nvar ANNOTATOR_NAME = \"\"\nvar ANNOTATION_VIDEO_NAME = \"\"\nvar VIDEO_METADATA = {}\n\n\nfunction save_data(frame_num){\n  frame_data[frame_num] = fabricCanvas.toJSON()\n  console.log(\"SAVED\")\n}\n\n\n//Current frame counter\nexport default function MainUpload() {\n\tconst [visualToggle, setVisualToggle] = useState(0);\n\tconst [annotationType, setAnnotationType] = useState(\"1\")\n\tconst [boxCount, setBoxCount] = useState(0)\n\tconst [videoFilePath, setVideoFileURL] = useState(null);\n\tconst [videoFilePath1, setVideoFileURL1] = useState(null);\n\tconst [oldAnnotation, setOldAnnotation] = useState(null)\n\tconst [player, setPlayer] = useState(null)\n\tconst [duration, setDuration] = useState(0);\n\tconst [show, setShow] = useState(false);\n\tconst [save, changeSave] = useState(false);\n\tconst [seeking, setSeeking] = useState(false)\n\tconst [playing, setPlaying] = useState(false);\n\tconst [currentFrame, setCurrentFrame] = useState(0)\n\n\tconst handleSetCurrentFrame = (val) => {\n\t\tif(typeof(val) === \"number\"){\n\t\t\tconsole.log(val)\n\t\t\tsetCurrentFrame(val)\n\t\t}else{\n\t\t\tconsole.log(val)\n\t\t\tsave_data(currentFrame)\n\t\t\tvar total_frames = duration * frame_rate\n\t\t\tvar frame_calc = (val['played']/total_frames)\n\t\t\tframe_calc = (Math.round(val['played']*total_frames))\n\t\t\tsetCurrentFrame(frame_calc)\n\t\t}\n\t}\n  \n  const remove_table_index = (index) => {\n\tvar index_num = 0;\n\n\tfor(var i = 0; i < annotation_data[currentFrame].length; i++){\n\t  if(annotation_data[currentFrame][i]['id'] == index){\n\t\tindex_num = i\n\t\tbreak;\n\t  }\n\t}\n\n\tif(index.substring(index.length-1, index.length) !== \"f\"){\n\t  for(var i = 0; i < fabricCanvas.getObjects().length; i++){\n\t\tif(fabricCanvas.getObjects()[i]['_objects'][1]['text'] === index){\n\t\t  fabricCanvas.remove(fabricCanvas.getObjects()[i]);\n\t\t  fabricCanvas.fire('saveData');\n\t\t  break;\n\t\t}\n\t  }\n\t}\n\tannotation_data[currentFrame].splice(index_num, 1)\n\tsave_data(currentFrame)\n\t//TODO make this more elegant - Currently makes a random number since the state change using an incremental update to the integer caused a stop of state updates and did not respond to any changes. This forces the values to be changed on random and should not have any dependence of the previous value of the visual toggle state.\n\tsetVisualToggle(Math.floor(Math.random() * 999999999999))\n  }\n  \n  \n\n  const save_previous_data = () => {\n\tif(annotation_data[currentFrame].length == 0){\n\t  return;\n\t}\n\tprevious_annotation = annotation_data[currentFrame]\n\tprevious_canvas_annotation = frame_data[currentFrame]\n  }\n\n  const addToCanvas = () =>{\n\tvar color = \"#\" + ((1<<24)*Math.random() | 0).toString(16)\n\t\n\tif(annotation_data[currentFrame] == null){\n\t  annotation_data[currentFrame] = []\n\t}\n\t\n\tvar annotation_type_txt = \"error\"\n\n\tif (annotationType === ANNOTATION_BBOX){\n\t\tannotation_type_txt = \"b\"\n\t  var new_bbox = new BoundingBox(fabricCanvas.height/2, fabricCanvas.width/2, 50, 50, color, boxCount+'b', \"None\").generate_no_behavior(fabricCanvas)\n\t  fabricCanvas.add(new_bbox)\n\t}else if (annotationType === ANNOTATION_KEYPOINT){\n\t  //TODO fix KeyPoint\n\t  alert(\"KeyPoint annotation are currently unavailable\")\n\t  annotation_type_txt = \"k\"\n\t  //var keyp = new KeyPoint().generate_stick(fabricCanvas)\n\t}else if (annotationType === ANNOTATION_SEG){\n\t  alert(\"Segmentation annotation is currently under development\")\n\t  //TODO Fix segmentation issues\n\t  annotation_type_txt = \"s\"\t  \n\t  var segment = new Segmentation().generate_polygon(fabricCanvas, boxCount+'s')\n\t}else if(annotationType === ANNOTATION_FRAME){\n\t  //TODO Add annotation frame datapoint\n\t  annotation_type_txt = \"f\"\n\t}\n\tannotation_data[currentFrame].push({id: boxCount+annotation_type_txt, global_id: null,status: \"\", current: \"\", behavior: \"\", posture: \"\"})\n\n\tsave_data(currentFrame)\n\tsetBoxCount(boxCount + 1);\n\tfabricCanvas.fire('saveData');\n  }\n\n  const handleVideoUpload = (event) => {\n\tsetVideoFileURL(URL.createObjectURL(event.target.files[0]));\n\tANNOTATION_VIDEO_NAME = event.target.files[0]['name']\n\tupload = true;\n  };\n\n  //ASYNC Function  - To note that the data that comes out of this will be a bit delayed and this could cause some issues.\n  const handleOldAnnotation = (event) => {\n\t  var promise = downloadOldAnnotation(event)\n\t  promise.then(function (result) {\n\t\tif(result != null){\n\t\t  setOldAnnotation(new ExtractingAnnotation(result));\n\t\t}else{\n\t\t  alert(\"Error in processing Annotation\")\n\t\t}\n\t  })\n  }\n\n  useEffect(() => {\n\t//TODO Find a more elegant solution. This is a temporay patch work.\n\tif(oldAnnotation == null){\n\t  return;\n\t}\n\talert(\"Annotation upload processed.\\nAny existing annotations will be deleted and replaced with uploaded ones.\")\n\tframe_data = oldAnnotation.get_frame_data();\n\tannotation_data = oldAnnotation.get_annotation_data();\n\thandle_visual_toggle()\n  }, oldAnnotation);\n\n  const downloadOldAnnotation = (file) => {\n\treturn new Promise((resolve, reject) => {\n\t  var reader = new FileReader();\n\t  reader.onload = function(e) {\n\t\t resolve((JSON.parse(e.target.result)));\n\t  }\n\t  reader.readAsText(file.target.files[0])\n\t})\n  }\n  \n\n  const handlePlaying = (event) => {\n\tsave_previous_data()\n\tsetPlaying(!playing)\n  }\n\n  var play_button_text = \"ERROR\"\n  if(playing === true){\n\tplay_button_text = \"Pause\"\n  }else{\n  play_button_text = \"Play\"\n  }\n\n\n\n  const handleSeekChange = e => {\n\tsliderPercent = (parseFloat(e.target.value))\n\tconsole.log(sliderPercent)\n  }\n\n  const handleSeekMouseDown = e => {\n\tsetSeeking(true)\n  }\n\n  const handleSeekMouseUp = e => {\n\tsetSeeking(false)\n\tplayer.seekTo(parseFloat(e.target.value))\n  }\n\n  const handleSetPlayer = val => {\n\tif(val != null){\n\t  if(val['player'] != null){\n\t\tif(val['player']['player'] != null){\n\t\t  if(val['player']['player'] != null){\n\t\t\tvideo_width = val['player']['player']['player'].videoWidth\n\t\t\tvideo_height = val['player']['player']['player'].videoHeight\n\t\t\tvar duration = val['player']['player']['player'].duration\n\t\t\tVIDEO_METADATA = {name: ANNOTATION_VIDEO_NAME, duration: duration, horizontal_res: video_width, vertical_res: video_height, frame_rate: frame_rate}\n\t\t\t//alert(\"*Loaded player* \\nHorizontal Resolution = \" + video_width + \"\\nVertical Resolution = \" + video_height + \"\\nFrame Rate: \" + frame_rate + \" FPS\\nDuration: \" + duration + \" seconds\")\n\t\t  }\n\t\t}\n\t  }\n\t}\n\tsetPlayer(val)\n  }\n\n  const handleSetDuration = val => {\n\tif(upload === true && player != null){      \n\t  num_frames = Math.round(val * frame_rate);\n\n\t  frame_data = new Array(num_frames)\n\t  annotation_data = new Array(num_frames)\n\n\t  //TODO Update this later\n\t  for (var i = 0; i < num_frames; i++){\n\t\tframe_data[i] = []\n\t\tannotation_data[i] = []\n\t  }\n\t  upload = false;\n\t  disable_buttons = false\n\t}\n\tsetDuration(parseInt(val))\n  }\n\n  const [scrubbing, setScrubbing] = useState(true);\n\n  const skip_frame_forward = e =>{\n\tsave_previous_data()\n\tif(scrubbing === false){\n\t  if (annotation_data[currentFrame+skip_value].length === 0){\n\t\tannotation_data[currentFrame+skip_value] = JSON.parse(JSON.stringify(annotation_data[currentFrame]));\n\t\tframe_data[currentFrame+skip_value] = frame_data[currentFrame];\n\t  }\n\t}\n\n\tvar total_frames = duration * frame_rate\n\tplayer.seekTo((((player.getCurrentTime()/duration)*total_frames))/(total_frames) + (skip_value/total_frames))\n  }\n\n  const skip_frame_backward = e => {\n\tsave_previous_data()\n\tvar total_frames = duration * frame_rate\n\tplayer.seekTo((((player.getCurrentTime()/duration)*total_frames))/(total_frames) - (skip_value/total_frames))\n  }\n\n\n\n  const handleClose = () => setShow(false);\n  const handleShow = () => setShow(true);\n\n  \n  const [keyCheck, changeKeyCheck] = useState(true)\n  const handle_key_check = (event) => {\n\tchangeKeyCheck(!keyCheck)\n\tconsole.log(\"Changing keyCheck to: \" + keyCheck)\n  }\n\n  const change_skip_value = (event) => {\n\t  skip_value = event\n  }\n\n  const change_annotation_type = (event) => {\n\t  console.log(event)\n\tsetAnnotationType(event)\n  }\n\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  const onKeyPress = (event) =>{\n\t//Making sure input for textbox doesnt get counted as a mode change\n\tif(keyCheck == false){\n\t  return;\n\t}\n\t//TODO Add keystroke disabling when typing in values in other parts\n\n\tif (event.key === ANNOTATION_BBOX){\n\t  toast_text = \"Mode Switch: Bounding Box\"\n\t  changeSave(true)\n\t  setAnnotationType(ANNOTATION_BBOX)\n\t}else if (event.key === ANNOTATION_KEYPOINT){\n\t  toast_text = \"Mode Switch: Key Point\"\n\t  changeSave(true)\n\t  setAnnotationType(ANNOTATION_KEYPOINT)\n\t}else if(event.key === ANNOTATION_SEG) {\n\t  toast_text = \"Mode Switch: Segmentation\"\n\t  changeSave(true)\n\t  setAnnotationType(ANNOTATION_SEG)\n\t}else if(event.key === ANNOTATION_FRAME){\n\t  toast_text = \"Mode Switch: Behavior Annotation\"\n\t  changeSave(true)\n\t  setAnnotationType(ANNOTATION_FRAME)\n\t}else if (event.key === \"a\"){\n\t  var annotext = \"\"\n\t  if(annotationType === ANNOTATION_BBOX){\n\t\tannotext = \"Bounding Box\"\n\t  }else if(annotationType === ANNOTATION_FRAME){\n\t\tannotext = \"Behavior Data\"\n\t  }else if (annotationType === ANNOTATION_KEYPOINT){\n\t\tannotext = \"Keypoint\"\n\t  }else if (annotationType === ANNOTATION_SEG){\n\t\tannotext = \"Segmentation\"\n\t  }\n\t  toast_text = \"Added Annotation - \" + annotext\n\t  changeSave(true)\n\t  addToCanvas()\n\t}else if (event.key === \"r\"){\n\t  //TODO Determine if having a remove key is efficient or the deletion can be done directly from UI\n\t  //toast_text = \"Removed Annotation\"\n\t  //changeSave(true)\n\t  //remove()\n\t}else if (event.key === \"q\"){\n\t  skip_frame_backward()\n\t}else if (event.key === \"w\"){\n\t  handlePlaying()\n\t}else if (event.key === \"e\"){\n\t  skip_frame_forward()\n\t}else if (event.key === \"s\"){\n\t  toast_text = \"Annotation Saved\"\n\t  changeSave(true)\n\t  frame_data[currentFrame] = fabricCanvas.toJSON()\n\t}else if (event.key === \"f\"){\n\t  if(scrubbing === false){\n\t\ttoast_text = \"Scrubbing Mode Activated\"\n\t\tsetScrubbing(true)\n\t\tchangeSave(true)\n\t  }else{\n\t\ttoast_text = \"Scrubbing Mode Deactivated\"\n\t\tsetScrubbing(false)\n\t\tchangeSave(true)\n\t  }\n\t}else if(event.key === \"c\"){\n\t  toast_text = \"Copying previous frame annotation\"\n\t  annotation_data[currentFrame] = JSON.parse(JSON.stringify(previous_annotation))\n\t  frame_data[currentFrame] = JSON.parse(JSON.stringify(previous_canvas_annotation))\n\t  changeSave(true)\n\t}\n  }  \n\n  useEffect(() => {\n\tdocument.addEventListener(\"keydown\", onKeyPress);\n\treturn () => document.removeEventListener(\"keydown\", onKeyPress);\n  }, [onKeyPress]);\n  \n  fabricCanvas.loadFromJSON(frame_data[currentFrame], function() {\n\tfabricCanvas.renderAll();\n  });\n\n  const handle_link_open = () => {\n\twindow.open(\"https://forms.gle/CrJuYEoT39uFgnR17\", \"_blank\")\n  }\n\n  const change_annotator_name = (event) => {\n\t  ANNOTATOR_NAME = event\n\t  console.log(ANNOTATOR_NAME)\n  }\n\n\n  /*\n\t<NavDropdown disabled={disable_buttons} title=\"Mode\" id=\"basic-nav-dropdown\">\n\t<NavDropdown.Item onClick={setAnnotationType(ANNOTATION_BBOX)} >Square Box</NavDropdown.Item>\n\t<NavDropdown.Divider />\n\t<NavDropdown.Item onClick={setAnnotationType(ANNOTATION_KEYPOINT)}>Key Point</NavDropdown.Item>\n\t<NavDropdown.Divider />\n\t<NavDropdown.Item onClick={setAnnotationType(ANNOTATION_SEG)}>Segmentation</NavDropdown.Item>\n  </NavDropdown>\n  */ \n  const handle_visual_toggle = () => {\n\tsetVisualToggle(Math.floor(Math.random() * 999999999999))\n  }\n\n  return (\n\t<div>\n\t\t<CustomNavBar \n\t\t\tdisable_buttons={disable_buttons} \n\t\t\tvideo_width={video_width} \n\t\t\tvideo_height={video_height} \n\t\t\tskip_value={skip_value} \n\t\t\tANNOTATOR_NAME={ANNOTATOR_NAME}\n\t\t\thandle_link_open={handle_link_open}\n\t\t\thandleOldAnnotation={handleOldAnnotation}\n\t\t\thandleVideoUpload={handleVideoUpload}\n\t\t\tcurrentFrame={currentFrame}\n\t\t\tdisplay_frame_num={\"Frame #\" + parseInt(currentFrame)+' / '+parseInt(duration * frame_rate)}\n\t\t\tskip_frame_forward={skip_frame_forward}\n\t\t\tskip_frame_backward={skip_frame_backward}\n\t\t\thandlePlaying={handlePlaying}\n\t\t\tplay_button_text={play_button_text}\n\t\t\taddToCanvas={addToCanvas}\n\t\t\tANNOTATION_VIDEO_NAME={ANNOTATION_VIDEO_NAME}\n\t\t\tframe_data={frame_data}\n\t\t\tchange_skip_value={change_skip_value}\n\t\t\tchange_annotator_name={change_annotator_name}\n\t\t\tchange_annotation_type={change_annotation_type}\n\t\t\tannotation_data={annotation_data}\n\t\t\tVIDEO_METADATA={VIDEO_METADATA}\n\t\t\tscaling_factor_height={scaling_factor_height}\n\t\t\tscaling_factor_width={scaling_factor_width}\n\t\t\tcolumns={columns}\n\t\t/>\n\t\t<Toast \n\t\t\tonClose={() => changeSave(false)} \n\t\t\tshow={save} delay={500} autohide\n\t\t\tstyle={{ position: 'absolute',top: 0, left: '40%', zIndex: 100}}\n\t\t>\n\t\t\t<Toast.Header>\n\t\t\t\t<strong className=\"mr-auto\">{toast_text}</strong>\n\t\t\t</Toast.Header>\n\t\t</Toast>\n\n\t\t<div style={{display: \"grid\"}}>\n\t\t\t<div style={{gridColumn: 1, gridRow:1, position: \"relative\", width: scaling_factor_width, height: scaling_factor_height, top: 0, left: 0}}>\n\t\t\t\t<ReactPlayer \n\t\t\t\tonProgress={handleSetCurrentFrame} \n\t\t\t\tref={handleSetPlayer} \n\t\t\t\tonDuration={handleSetDuration} \n\t\t\t\turl={videoFilePath} \n\t\t\t\twidth='100%'\n\t\t\t\theight='99.999%'\n\t\t\t\tplaying={playing} \n\t\t\t\tcontrols={false} \n\t\t\t\tstyle={{position:'absolute', float:'left', top:0, left:0}}\n\t\t\t\tvolume={0}\n\t\t\t\tmuted={true}\n\t\t\t\tpip={false}\n\t\t\t\tplaybackRate={5}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div style={{gridColumn: 1, gridRow:1, position: \"relative\",  top: 0, left: 0}}>\n\t\t\t\t<FabricRender \n\t\t\t\t\tfabricCanvas={fabricCanvas}\n\t\t\t\t\tcurrentFrame={currentFrame}\n\t\t\t\t\tsave_data={save_data}\n\t\t\t\t\tscaling_factor_height={scaling_factor_height}\n\t\t\t\t\tscaling_factor_width={scaling_factor_width}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div style={{gridColumn: 1, gridRow:2, position: \"relative\", width: scaling_factor_width, top: 0, left: 0}}>\n\t\t\t\t<input\n\t\t\t\t\tstyle={{width: scaling_factor_width}}\n\t\t\t\t\ttype='range' min={0} max={0.999999} step='any'\n\t\t\t\t\tvalue={sliderPercent}\n\t\t\t\t\tonMouseDown={handleSeekMouseDown}\n\t\t\t\t\tonChange={handleSeekChange}\n\t\t\t\t\tonMouseUp={handleSeekMouseUp}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div style={{gridColumn: 2, gridRow:1, position: \"relative\",width: scaling_factor_width*.4, height: scaling_factor_height, top: 0, left: 0}}>\n\t\t\t\t<Tabs defaultActiveKey=\"profile\" id=\"uncontrolled-tab-example\">\n\t\t\t\t\t<Tab eventKey=\"home\" title=\"Current\">\n\t\t\t\t\t\t<BootstrapTable\n\t\t\t\t\t\t\tkeyField='id'\n\t\t\t\t\t\t\tdata={annotation_data[currentFrame]} \n\t\t\t\t\t\t\tcolumns={columns(remove_table_index)}\n\t\t\t\t\t\t\ttable\n\t\t\t\t\t\t\tnoDataIndication={ () => <div>No recorded annotations or behaviors for this frame<br/>Please add an annotation or behavior tag to start.</div> }\n\t\t\t\t\t\t\tcellEdit={\n\t\t\t\t\t\t\tcellEditFactory({ mode: 'click', blurToSave: true,\n\t\t\t\t\t\t\t\tafterSaveCell: (oldValue, newValue, row, column) => {\n\t\t\t\t\t\t\t\t\tannotation_data[currentFrame][row['id']] = row\n\t\t\t\t\t\t\t\t\tchangeKeyCheck(true)\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tonStartEdit: (row, column, rowIndex, columnIndex) => {\n\t\t\t\t\t\t\t\t\tchangeKeyCheck(false)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}) \n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tpagination={ paginationFactory() }\n\t\t\t\t\t\t/>\n\t\t\t\t\t</Tab>\n\t\t\t\t\t<Tab eventKey=\"profile\" title=\"Previous\">\n\t\t\t\t\t\t{\"Prev Annotated frames will go here :)\\n In Progress!\"}\n\t\t\t\t\t</Tab>\n\t\t\t\t</Tabs>\n\t\t\t</div>\n\t\t\n\t\t</div>\n\t</div>\n  );\n}\n\n\n","export const ANNOTATION_FRAME = \"1\"\nexport const ANNOTATION_BBOX = \"2\"\nexport const ANNOTATION_KEYPOINT = \"3\"\nexport const ANNOTATION_SEG = \"4\"\n\n","//Core imports\nimport React, { useEffect, useState } from \"react\"; \nimport ReactDOM from 'react-dom'\nimport ReactPlayer from 'react-player'\nimport 'bootstrap/dist/css/bootstrap.min.css';\n\n//UI Element imports\nimport Button from 'react-bootstrap/Button'\nimport Navbar from 'react-bootstrap/Navbar'\nimport Nav from 'react-bootstrap/Nav'\nimport Modal from 'react-bootstrap/Modal'\nimport Form from 'react-bootstrap/Form'\nimport Toast from 'react-bootstrap/Toast'\n\n//Annotation Processing\nimport ExtractingAnnotation from '../../processing/annotation-processing'\n\n//Annotations\nimport { BoundingBox } from '../../annotations/bounding_box'\nimport { KeyPoint } from '../../annotations/key_point'\nimport { Segmentation } from '../../annotations/segmentation'\n\n//Table imports\nimport BootstrapTable from 'react-bootstrap-table-next';\nimport cellEditFactory from 'react-bootstrap-table2-editor';\nimport 'react-bootstrap-table-next/dist/react-bootstrap-table2.min.css';\nimport paginationFactory from 'react-bootstrap-table2-paginator';\n\n//Column information + data structure\nimport {columns} from '../../static_data/columns'\n//import {columns_LPS} from '../../static_data/columns'\n\n//Components\nimport Instructions from \"../Components/instructions\";\nimport CustomNavBar from \"../Components/nav_bar\";\nimport FabricRender from \"../Components/fabric_canvas\";\n\n//TODO add local storage functionality to auto-save\nif (typeof(Storage) === \"undefined\") {\n\t// Code for localStorage/sessionStorage.\n\talert('Your browser does not support local storage. \\nSome autosaving features of the app will not work as intended.\\nPlease see the documentation to find supported browsers and their versions')\n}\n\nconst ANNOTATION_FRAME = \"1\"\nconst ANNOTATION_BBOX = \"2\"\nconst ANNOTATION_KEYPOINT = \"3\"\nconst ANNOTATION_SEG = \"4\"\n\nconst fabric = require(\"fabric\").fabric;\nconst createReactClass = require('create-react-class');\n\n\n\n//TODO ADD DYNAMIC SOLUTION \nvar frame_rate = 15;\nvar num_frames = -1;\nvar scaling_factor_width = 1920;\nvar scaling_factor_height = 1080;\nvar skip_value = 1;\n\nconsole.log(window.screen.width)\nconsole.log(window.screen.height)\n\nvar current_screen_width = window.screen.width;\nvar current_screen_height = window.screen.height;\n\n//Mappings are based off of https://en.wikipedia.org/wiki/List_of_common_resolutions make sure to use 1:1 and 16:9 aspect ratio\nif (current_screen_height >= 1440){\n\tscaling_factor_width = 1920;\n\tscaling_factor_height = 1080;\n}else if(current_screen_height >= 1080){\n\tscaling_factor_width = 1280;\n\tscaling_factor_height = 720;\n}else if(current_screen_height >= 1024){\n\tscaling_factor_width = 1152;\n\tscaling_factor_height = 648;\n}else if(current_screen_height >= 768){\n\tscaling_factor_width = 1024;\n\tscaling_factor_height = 576;\n}\n\n\n// globally accessable fabricCanvas instance\nvar fabricCanvas = new fabric.Canvas('c', {uniScaleTransform: true});\n\nvar video_width = 0;\nvar video_height = 0;\nvar frame_data = [[]];\nvar annotation_data = [[]];\nvar upload = false;\nvar disable_buttons = true;\nvar currentFrame = 0;\nvar sliderPercent = 0\nvar toast_text = \"\"\nvar previous_annotation = []\nvar previous_canvas_annotation = []\nvar ANNOTATOR_NAME = \"\"\nvar ANNOTATION_VIDEO_NAME = \"\"\n\n\nfunction save_data(frame_num){\n\tframe_data[frame_num] = fabricCanvas.toJSON()\n\tconsole.log(\"SAVED\")\n}\n\n\n//Current frame counter\nfunction MainYoutube() {\n\tconst remove_table_index = (index) => {\n\t\tvar index_num = 0;\n\n\t\tfor(var i = 0; i < annotation_data[currentFrame].length; i++){\n\t\t\tif(annotation_data[currentFrame][i]['id'] === index){\n\t\t\t\tindex_num = i\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif(index.substring(index.length-1, index.length) !== \"f\"){\n\t\t\tfor(var i = 0; i < fabricCanvas.getObjects().length; i++){\n\t\t\t\tif(fabricCanvas.getObjects()[i]['_objects'][1]['text'] === index){\n\t\t\t\t\tfabricCanvas.remove(fabricCanvas.getObjects()[i]);\n\t\t\t\t\tfabricCanvas.fire('saveData');\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tconsole.log(annotation_data[currentFrame])\n\t\tannotation_data[currentFrame].splice(index_num, 1)\n\t\tconsole.log(annotation_data[currentFrame])\n\t\tsave_data(currentFrame)\n\t\t//TODO make this more elegant - Currently makes a random number since the state change using an incremental update to the integer caused a stop of state updates and did not respond to any changes. This forces the values to be changed on random and should not have any dependence of the previous value of the visual toggle state.\n\t\tsetVisualToggle(Math.floor(Math.random() * 999999999999))\n\t}\n\n\tconst [visualToggle, setVisualToggle] = useState(0);\n\n\tconsole.log(visualToggle)\n\n\tconst save_previous_data = () => {\n\t\tif(annotation_data[currentFrame].length === 0){\n\t\t\treturn;\n\t\t}\n\t\tconsole.log(annotation_data[currentFrame].length === 0)\n\t\tconsole.log(\"saved annotation\")\n\t\tprevious_annotation = annotation_data[currentFrame]\n\t\tprevious_canvas_annotation = frame_data[currentFrame]\n\t}\n\n\tconst [annotationType, setAnnotationType] = useState(\"1\")\n\tconst handleAnnotationType = (event) => {\n\t\tconsole.log(event.target.value)\n\t}\n\n\tconst [boxCount, setBoxCount] = useState(0)\n\tconst addToCanvas = () =>{\n\t\tvar color = \"#\" + ((1<<24)*Math.random() | 0).toString(16)\n\t\t\n\t\tif(annotation_data[currentFrame] == null){\n\t\t\tannotation_data[currentFrame] = []\n\t\t}\n\t\t\n\t\tif (annotationType === ANNOTATION_BBOX){\n\t\t\tannotation_data[currentFrame].push({id: boxCount+'b', global_id: null,status: \"\", current: \"Start\", behavior: \"None\"})\n\t\t\tvar new_bbox = new BoundingBox(fabricCanvas.height/2, fabricCanvas.width/2, 50, 50, color, boxCount+'b', \"None\").generate_no_behavior(fabricCanvas)\n\t\t\tfabricCanvas.add(new_bbox)\n\t\t}else if (annotationType === ANNOTATION_KEYPOINT){\n\t\t\t//TODO fix KeyPoint\n\t\t\talert(\"KeyPoint annotation are currently unavailable\")\n\t\t\t//annotation_data[currentFrame].push({id: boxCount+'k', behavior: \"None\", is_hidden: 0, posture: \"None\"})\n\t\t\t//var keyp = new KeyPoint().generate_stick(fabricCanvas)\n\t\t}else if (annotationType === ANNOTATION_SEG){\n\t\t\talert(\"Segmentation annotation is currently under development\")\n\t\t\t//TODO Fix segmentation issues\n\t\t\tannotation_data[currentFrame].push({id: boxCount+'s', global_id:null, status: \"None\", current: \"Start\", behavior: \"None\"})\n\t\t\tvar segment = new Segmentation().generate_polygon(fabricCanvas, boxCount+'s')\n\t\t}else if(annotationType === ANNOTATION_FRAME){\n\t\t\t//TODO Add annotation frame datapoint\n\t\t\tannotation_data[currentFrame].push({id: boxCount+'f', global_id: null,status: \"\", current: \"Start\", behavior: \"None\"})\n\t\t}\n\t\tsave_data(currentFrame)\n\t\tsetBoxCount(boxCount + 1);\n\t\tfabricCanvas.fire('saveData');\n\t}\n\n\tconst remove = () => {\n\t\tsetBoxCount(boxCount + 1)\n\t\tif(fabricCanvas.getActiveObject() === null){\n\t\t\tconsole.log(fabricCanvas.getObjects())\n\t\t\talert(\"Please select a bounding box / segmentation from the screen to delete.\")\n\t\t\t//return\n\t\t}\n\t\tconsole.log(fabricCanvas.getActiveObject())\n\t\tvar index = fabricCanvas.getActiveObject().toJSON()['local_id']\n\t\tfor(var i = 0; i < annotation_data[currentFrame].length; i++){\n\t\t\tif (annotation_data[currentFrame][i]['id'] === index){\n\t\t\t\tannotation_data[currentFrame].splice(i, 1)\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tfabricCanvas.remove(fabricCanvas.getActiveObject());\n\t\tfabricCanvas.fire('saveData');\n\t}\n\n\tconst [videoFilePath, setVideoFileURL] = useState(null);\n\tconst handleVideoUpload = (event) => {\n\t\tsetVideoFileURL(URL.createObjectURL(event.target.files[0]));\n\t\tconsole.log(event.target.files[0])\n\t\tANNOTATION_VIDEO_NAME = event.target.files[0]['name']\n\t\tupload = true;\n\t};\n\n\t//Code for dual video upload option. Currently disabled\n\tconst [videoFilePath1, setVideoFileURL1] = useState(null);\n\tconst handleVideoUpload1 = (event) => {\n\t\tsetVideoFileURL1(URL.createObjectURL(event.target.files[0]));\n\t};\n\n\t//ASYNC Function  - To note that the data that comes out of this will be a bit delayed and this could cause some issues.\n\tconst [oldAnnotation, setOldAnnotation] = useState(null)\n\tconst handleOldAnnotation = (event) => {\n\t\t\tvar promise = downloadOldAnnotation(event)\n\t\t\tpromise.then(function (result) {\n\t\t\t\tif(result != null){\n\t\t\t\t\tsetOldAnnotation(new ExtractingAnnotation(result));\n\t\t\t\t}else{\n\t\t\t\t\tconsole.log(\"ERROR in upload old_annotation\")\n\t\t\t\t}\n\t\t\t})\n\t}\n\n\tuseEffect(() => {\n\t\t//TODO Find a more elegant solution. This is a temporay patch work.\n\t\tif(oldAnnotation == null){\n\t\t\treturn;\n\t\t}\n\t\talert(\"Annotation upload processed.\\nAny existing annotations will be deleted and replaced with uploaded ones.\")\n\t\tconsole.log(oldAnnotation)\n\t\tconsole.log(oldAnnotation.get_frame_data());\n\t\tframe_data = oldAnnotation.get_frame_data();\n\t\tannotation_data = oldAnnotation.get_annotation_data();\n\t\thandle_visual_toggle()\n\t}, oldAnnotation);\n\n\tconst downloadOldAnnotation = (file) => {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tvar reader = new FileReader();\n\t\t\treader.onload = function(e) {\n\t\t\t\t\tresolve((JSON.parse(e.target.result)));\n\t\t\t}\n\t\t\treader.readAsText(file.target.files[0])\n\t\t})\n\t}\n\n\n\tconst [playing, setPlaying] = useState(false);\n\tconst handlePlaying = (event) => {\n\t\tsetPlaying(!playing)\n\t}\n\n\tvar play_button_text = \"ERROR\"\n\tif(playing === true){\n\t\tplay_button_text = \"Pause\"\n\t}else{\n\tplay_button_text = \"Play\"\n\t}\n\n\tconst [seeking, setSeeking] = useState(false)\n\n\n\tconst handleSeekChange = e => {\n\t\tsliderPercent = (parseFloat(e.target.value))\n\t}\n\n\tconst handleSeekMouseDown = e => {\n\t\tsetSeeking(true)\n\t}\n\n\tconst handleSeekMouseUp = e => {\n\t\tsetSeeking(false)\n\t\tplayer.seekTo(parseFloat(e.target.value))\n\t}\n\n\tconst [player, setPlayer] = useState(null)\n\tconst handleSetPlayer = val => {\n\t\t//console.log(val)\n\t\tif(val != null){\n\t\t\tif(val['player'] != null){\n\t\t\t\tif(val['player']['player'] != null){\n\t\t\t\t\tif(val['player']['player'] != null){\n\t\t\t\t\t\tvideo_width = val['player']['player']['player'].videoWidth\n\t\t\t\t\t\tvideo_height = val['player']['player']['player'].videoHeight\n\t\t\t\t\t\tvar duration = val['player']['player']['player'].duration\n\t\t\t\t\t\t//alert(\"*Loaded player* \\nHorizontal Resolution = \" + video_width + \"\\nVertical Resolution = \" + video_height + \"\\nFrame Rate: \" + frame_rate + \" FPS\\nDuration: \" + duration + \" seconds\")\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tsetPlayer(val)\n\t}\n\n\t//TODO Autoset resolution\n\n\n\n\tconst [duration, setDuration] = useState(0);\n\tconst handleSetDuration = val => {\n\t\tif(upload === true && player != null){      \n\t\t\tconsole.log(\"Initializing...\")\n\t\t\tnum_frames = Math.round(val * frame_rate);\n\n\t\t\tframe_data = new Array(num_frames)\n\t\t\tannotation_data = new Array(num_frames)\n\n\t\t\t//TODO Update this later\n\t\t\tfor (var i = 0; i < num_frames; i++){\n\t\t\t\tframe_data[i] = []\n\t\t\t\tannotation_data[i] = []\n\t\t\t}\n\t\t\tupload = false;\n\t\t\tdisable_buttons = false\n\t\t}\n\t\tsetDuration(parseInt(val))\n\t\tconsole.log(val)\n\t}\n\n\n\tconst handleSetCurrentFrame = val => {\n\t\tsave_data(currentFrame)\n\t\tvar total_frames = duration * frame_rate\n\t\tcurrentFrame = (val['played']/total_frames)\n\t\tcurrentFrame = (Math.round(val['played']*total_frames))\n\t\thandle_visual_toggle()\n\t\t/*if(oldAnnotation != null){ //ANNOTATIONS FOR MCPT (Multi Camera Pig Tracking) additions. TODO add in another class to process all instead of doing per-frame basis which is slow and inefficient.)\n\t\t\t//fabricCanvas.clear();\n\t\t\tvar bbox = new FrameBoundingBox(oldAnnotation.getAllObjectByFrame(currentFrame), scaling_factor_width, scaling_factor_height).generate_frame()\n\t\t\tfor(var i = 0; i < bbox.length; i++){\n\t\t\t\tvar curr_obj = bbox[i]\n\t\t\t\tconsole.log(curr_obj)\n\t\t\t\tfabricCanvas.add(curr_obj);\n\t\t\t\tfabricCanvas.setActiveObject(curr_obj);\n\t\t\t\tfabricCanvas.fire('saveData');\n\t\t\t}\n\t\t}*/\n\n\t}\n\n\tconst [scrubbing, setScrubbing] = useState(true);\n\n\tconst skip_frame_forward = e =>{\n\t\tsave_previous_data()\n\t\tif(scrubbing === false){\n\t\t\tif (annotation_data[currentFrame+skip_value].length == 0){\n\t\t\t\tannotation_data[currentFrame+skip_value] = JSON.parse(JSON.stringify(annotation_data[currentFrame]));\n\t\t\t\tframe_data[currentFrame+skip_value] = frame_data[currentFrame];\n\t\t\t\tconsole.log(\"Carryover annotation\")\n\t\t\t}\n\t\t}\n\n\t\tvar total_frames = duration * frame_rate\n\t\tconsole.log((((player.getCurrentTime()/duration)*total_frames))/(total_frames) + (skip_value/total_frames))\n\t\tplayer.seekTo((((player.getCurrentTime()/duration)*total_frames))/(total_frames) + (skip_value/total_frames))\n\t}\n\n\tconst skip_frame_backward = e => {\n\t\tsave_previous_data()\n\t\tvar total_frames = duration * frame_rate\n\t\tplayer.seekTo((((player.getCurrentTime()/duration)*total_frames))/(total_frames) - (skip_value/total_frames))\n\t}\n\n\tconst downloadFile = async () => {\n\t\tvar fileName = \"generated_annotations\";\n\t\tif(ANNOTATION_VIDEO_NAME !== \"\" && ANNOTATOR_NAME !== \"\"){\n\t\t\tfileName = ANNOTATION_VIDEO_NAME.split('.').slice(0, -1).join('.') + \"_\" +  ANNOTATOR_NAME\n\t\t}\n\t\t//const json = JSON.stringify(fabricCanvas.getObjects());\n\t\tconst json = JSON.stringify({\"annotations\": frame_data, \"behavior_data\": annotation_data})\n\t\t//var json = JSON.stringify(frame_data);\n\t\tvar blob = new Blob([json],{type:'application/json'});\n\t\tvar href = await URL.createObjectURL(blob);\n\t\tvar link = document.createElement('a');\n\t\tlink.href = href;\n\t\tlink.download = fileName + \".json\";\n\t\tdocument.body.appendChild(link);\n\t\tlink.click();\n\t\tdocument.body.removeChild(link);\n\n\n\t}\n\n\tconst [show, setShow] = useState(false);\n\n\tconst handleClose = () => setShow(false);\n\tconst handleShow = () => setShow(true);\n\n\tconst [save, changeSave] = useState(false);\n\n\tconst [keyCheck, changeKeyCheck] = useState(true)\n\tconst handle_key_check = (event) => {\n\t\tchangeKeyCheck(!keyCheck)\n\t\tconsole.log(\"Changing keyCheck to: \" + keyCheck)\n\t}\n\n\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\tconst onKeyPress = (event) =>{\n\t\t//Making sure input for textbox doesnt get counted as a mode change\n\t\tif(keyCheck == false){\n\t\t\treturn;\n\t\t}\n\t\t//TODO Add keystroke disabling when typing in values in other parts\n\n\t\tif (event.key === ANNOTATION_BBOX){\n\t\t\ttoast_text = \"Mode Switch: Bounding Box\"\n\t\t\tchangeSave(true)\n\t\t\tsetAnnotationType(ANNOTATION_BBOX)\n\t\t}else if (event.key === ANNOTATION_KEYPOINT){\n\t\t\ttoast_text = \"Mode Switch: Key Point\"\n\t\t\tchangeSave(true)\n\t\t\tsetAnnotationType(ANNOTATION_KEYPOINT)\n\t\t}else if(event.key === ANNOTATION_SEG) {\n\t\t\ttoast_text = \"Mode Switch: Segmentation\"\n\t\t\tchangeSave(true)\n\t\t\tsetAnnotationType(ANNOTATION_SEG)\n\t\t}else if(event.key === ANNOTATION_FRAME){\n\t\t\ttoast_text = \"Mode Switch: Behavior Annotation\"\n\t\t\tchangeSave(true)\n\t\t\tsetAnnotationType(ANNOTATION_FRAME)\n\t\t}else if (event.key === \"a\"){\n\t\t\tvar annotext = \"\"\n\t\t\tif(annotationType === ANNOTATION_BBOX){\n\t\t\t\tannotext = \"Bounding Box\"\n\t\t\t}else if(annotationType === ANNOTATION_FRAME){\n\t\t\t\tannotext = \"Behavior Data\"\n\t\t\t}else if (annotationType === ANNOTATION_KEYPOINT){\n\t\t\t\tannotext = \"Keypoint\"\n\t\t\t}else if (annotationType === ANNOTATION_SEG){\n\t\t\t\tannotext = \"Segmentation\"\n\t\t\t}\n\t\t\ttoast_text = \"Added Annotation - \" + annotext\n\t\t\tchangeSave(true)\n\t\t\taddToCanvas()\n\t\t}else if (event.key === \"r\"){\n\t\t\t//TODO Determine if having a remove key is efficient or the deletion can be done directly from UI\n\t\t\t//toast_text = \"Removed Annotation\"\n\t\t\t//changeSave(true)\n\t\t\t//remove()\n\t\t}else if (event.key === \"q\"){\n\t\t\tskip_frame_backward()\n\t\t}else if (event.key === \"w\"){\n\t\t\thandlePlaying()\n\t\t}else if (event.key === \"e\"){\n\t\t\tskip_frame_forward()\n\t\t}else if (event.key === \"s\"){\n\t\t\ttoast_text = \"Annotation Saved\"\n\t\t\tchangeSave(true)\n\t\t\tframe_data[currentFrame] = fabricCanvas.toJSON()\n\t\t}else if (event.key === \"f\"){\n\t\t\tif(scrubbing === false){\n\t\t\t\ttoast_text = \"Scrubbing Mode Activated\"\n\t\t\t\tsetScrubbing(true)\n\t\t\t\tchangeSave(true)\n\t\t\t}else{\n\t\t\t\ttoast_text = \"Scrubbing Mode Deactivated\"\n\t\t\t\tsetScrubbing(false)\n\t\t\t\tchangeSave(true)\n\t\t\t}\n\t\t}else if(event.key === \"c\"){\n\t\t\ttoast_text = \"Copying previous frame annotation\"\n\t\t\tannotation_data[currentFrame] = JSON.parse(JSON.stringify(previous_annotation))\n\t\t\tframe_data[currentFrame] = JSON.parse(JSON.stringify(previous_canvas_annotation))\n\t\t\tchangeSave(true)\n\t\t}\n\t}  \n\n\tuseEffect(() => {\n\t\tdocument.addEventListener(\"keydown\", onKeyPress);\n\t\treturn () => document.removeEventListener(\"keydown\", onKeyPress);\n\t}, [onKeyPress]);\n\n\tfabricCanvas.loadFromJSON(frame_data[currentFrame], function() {\n\t\tfabricCanvas.renderAll();\n\t});\n\n\tconst handle_link_open = () => {\n\t\twindow.open(\"https://forms.gle/CrJuYEoT39uFgnR17\", \"_blank\")\n\t}\n\n\t/*\n\t\t<NavDropdown disabled={disable_buttons} title=\"Mode\" id=\"basic-nav-dropdown\">\n\t\t<NavDropdown.Item onClick={setAnnotationType(ANNOTATION_BBOX)} >Square Box</NavDropdown.Item>\n\t\t<NavDropdown.Divider />\n\t\t<NavDropdown.Item onClick={setAnnotationType(ANNOTATION_KEYPOINT)}>Key Point</NavDropdown.Item>\n\t\t<NavDropdown.Divider />\n\t\t<NavDropdown.Item onClick={setAnnotationType(ANNOTATION_SEG)}>Segmentation</NavDropdown.Item>\n\t</NavDropdown>\n\t*/ \n\tconst handle_visual_toggle = () => {\n\t\tsetVisualToggle(visualToggle+1)\n\t}\n\n\treturn (\n\t\t<div>\n\t\t<CustomNavBar \n\t\t\tdisable_buttons={disable_buttons} \n\t\t\tdownloadFile={downloadFile} \n\t\t\tvideo_width={video_width} \n\t\t\tvideo_height={video_height} \n\t\t\tskip_value={skip_value} \n\t\t\tANNOTATOR_NAME={ANNOTATOR_NAME}\n\t\t\thandle_link_open={handle_link_open}\n\t\t\thandleOldAnnotation={handleOldAnnotation}\n\t\t\thandleVideoUpload={handleVideoUpload}\n\t\t\tcurrentFrame={currentFrame}\n\t\t\tdisplay_frame_num={\"Frame #\" + parseInt(currentFrame)+' / '+parseInt(duration * frame_rate)}\n\t\t\tskip_frame_forward={skip_frame_forward}\n\t\t\tskip_frame_backward={skip_frame_backward}\n\t\t\thandlePlaying={handlePlaying}\n\t\t\tplay_button_text={play_button_text}\n\t\t\taddToCanvas={addToCanvas}\n\t\t/>\n\t\t<Toast \n\t\t\tonClose={() => changeSave(false)} \n\t\t\tshow={save} delay={500} autohide\n\t\t\tstyle={{ position: 'absolute',top: 0, left: '40%', zIndex: 100}}\n\t\t>\n\t\t\t<Toast.Header>\n\t\t\t\t<strong className=\"mr-auto\">{toast_text}</strong>\n\t\t\t</Toast.Header>\n\t\t</Toast>\n\t\t<Modal show={show} onHide={handleClose} size='lg'>\n\t\t\t<Modal.Header closeButton>\n\t\t\t<Modal.Title>Instructions</Modal.Title>\n\t\t\t</Modal.Header>\n\t\t\t<Modal.Body><Instructions></Instructions></Modal.Body>\n\t\t\t<Modal.Footer>\n\t\t\t<Button variant=\"secondary\" onClick={handleClose}>Close</Button>\n\t\t\t</Modal.Footer>\n\t\t</Modal>\n\t\t<div style={{display: \"grid\"}}>\n\t\t\t<div style={{gridColumn: 1, gridRow:1, position: \"relative\", width: scaling_factor_width, height: scaling_factor_height, top: 0, left: 0}}>\n\t\t\t\t<ReactPlayer \n\t\t\t\tonProgress={handleSetCurrentFrame} \n\t\t\t\tref={handleSetPlayer} \n\t\t\t\tonDuration={handleSetDuration} \n\t\t\t\turl={\"https://www.youtube.com/watch?v=MF6J2H983HY\"} \n\t\t\t\twidth='100%'\n\t\t\t\theight='99.999%'\n\t\t\t\tplaying={playing} \n\t\t\t\tcontrols={false} \n\t\t\t\tstyle={{position:'absolute', float:'left', top:0, left:0}}\n\t\t\t\tvolume={0}\n\t\t\t\tmuted={true}\n\t\t\t\tpip={false}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div style={{gridColumn: 1, gridRow:1, position: \"relative\",  top: 0, left: 0}}>\n\t\t\t\t<FabricRender \n\t\t\t\t\tfabricCanvas={fabricCanvas}\n\t\t\t\t\tcurrentFrame={currentFrame}\n\t\t\t\t\tsave_data={save_data}\n\t\t\t\t\tscaling_factor_height={scaling_factor_height}\n\t\t\t\t\tscaling_factor_width={scaling_factor_width}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div style={{gridColumn: 1, gridRow:2, position: \"relative\", width: scaling_factor_width, top: 0, left: 0}}>\n\t\t\t\t<input\n\t\t\t\t\tstyle={{width: scaling_factor_width}}\n\t\t\t\t\ttype='range' min={0} max={0.999999} step='any'\n\t\t\t\t\tvalue={sliderPercent}\n\t\t\t\t\tonMouseDown={handleSeekMouseDown}\n\t\t\t\t\tonChange={handleSeekChange}\n\t\t\t\t\tonMouseUp={handleSeekMouseUp}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div style={{gridColumn: 2, gridRow:1, position: \"relative\",width: scaling_factor_width*.4, height: scaling_factor_height, top: 0, left: 0}}>\n\t\t\t\t<div>\n\t\t\t\t<BootstrapTable\n\t\t\t\t\tkeyField='id'\n\t\t\t\t\tdata={annotation_data[currentFrame]} \n\t\t\t\t\tcolumns={columns(remove_table_index)}\n\t\t\t\t\ttable\n\t\t\t\t\tnoDataIndication={ () => <div>No recorded annotations or behaviors for this frame<br/>Please add an annotation or behavior tag to start.</div> }\n\t\t\t\t\tcellEdit={\n\t\t\t\t\tcellEditFactory({ mode: 'click', blurToSave: true,\n\t\t\t\t\t\tafterSaveCell: (oldValue, newValue, row, column) => {\n\t\t\t\t\t\t\t//console.log(annotation_data[currentFrame][row['id']])\n\t\t\t\t\t\t\tannotation_data[currentFrame][row['id']] = row\n\t\t\t\t\t\t\tchangeKeyCheck(true)\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonStartEdit: (row, column, rowIndex, columnIndex) => {\n\t\t\t\t\t\t\tchangeKeyCheck(false)\n\t\t\t\t\t\t}\n\t\t\t\t\t}) \n\t\t\t\t\t}\n\t\t\t\t\tpagination={ paginationFactory() }\n\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\n\t\t</div>\n\t\t</div>\n\t);\n}\n\n\nexport default MainYoutube;","import React, { useState } from \"react\"; \nimport 'bootstrap/dist/css/bootstrap.min.css';\n\nimport BootstrapTable from 'react-bootstrap-table-next';\nimport cellEditFactory, { Type } from 'react-bootstrap-table2-editor';\nimport 'react-bootstrap-table-next/dist/react-bootstrap-table2.min.css';\n\nimport {behaviors} from '../../static_data/behaviors'\nimport {posture} from '../../static_data/posture'\n\nconst columns = [{\n    dataField: \"id\",\n    text: \"ID\"\n},{\n    dataField: \"behavior\",\n    text: \"Beh\",\n    editor: {\n        type: Type.SELECT,\n        options: behaviors\n      }\n},{\n    dataField: \"is_hidden\",\n    text: \"Hid\"\n},{\n    dataField: \"posture\",\n    text: \"Pos\",\n    editor: {\n        type: Type.SELECT,\n        options: posture\n      }\n}]\n\nfunction json_to_table_ANIKET(data){\n    var ret = []\n    if(data == null){\n        return []\n    }\n    for(var i = 0; i < data['objects'].length; i++){\n        const elem_id = i + 1\n        var curr_obj = data['objects'][i]\n        console.log(curr_obj['left'])\n        ret.push({id: elem_id.toString(), behavior: \"None\", is_hidden: \"False\", posture: \"None\"})        \n    }\n    return ret\n}\n\nfunction json_to_table(data){\n    var ret = []\n    if (data == null){\n        return []\n    }\n    for(var i = 0; i < data.length; i++){\n        ret.push(data[i].generate_row())\n    }\n    \n\n    return ret\n}\n\nfunction ChangeTable(input){\n    //console.log(input.data)\n    const data = json_to_table(input.data)\n    return (\n        <div style={{width: \"15%\"}}>\n            <BootstrapTable condensed={true} keyField='id' data={data} columns={ columns } cellEdit={ cellEditFactory({ mode: 'click', blurToSave: true }) }/>\n        </div>\n    )\n}\n\nexport default ChangeTable;","const behaviors = [{\n    value: 'Other',\n    label: 'Other'\n},{\n    value: 'Lying',\n    label: 'Lying'\n},{\n    value: 'Standing',\n    label: 'Standing'\n},{\n    value: 'Sitting',\n    label: 'Sitting'\n},{\n    value: 'Kneeling',\n    label: 'Kneeling'\n},{\n    value: 'Scar',\n    label: 'Scar'\n},{\n    value: 'Facial',\n    label: 'Facial'\n},{\n    value: 'Skin',\n    label: 'Skin'\n},{\n    value: 'Walking',\n    label: 'Walking'\n},{\n    value: 'Running',\n    label: 'Running'\n},{\n    value: 'Transitioning',\n    label: 'Transitioning'\n},{\n    value: 'Exploring',\n    label: 'Exploring'\n},{\n    value: 'Selfplay',\n    label: 'Selfplay'\n},{\n    value: 'Aggression',\n    label: 'Aggression'\n},{\n    value: 'Defecation',\n    label: 'Defecation'\n},{\n    value: 'Urination',\n    label: 'Urination'\n},{\n    value: 'Drinking',\n    label: 'Drinking'\n},{\n    value: 'Feeding',\n    label: 'Feeding'\n}\n]\n\nexport {behaviors};","import React, { useEffect, useState } from \"react\"; \nimport ReactDOM from 'react-dom'\nimport ReactPlayer from 'react-player'\nimport 'bootstrap/dist/css/bootstrap.min.css';\n\nimport Button from 'react-bootstrap/Button'\nimport Navbar from 'react-bootstrap/Navbar'\nimport Nav from 'react-bootstrap/Nav'\nimport Modal from 'react-bootstrap/Modal'\nimport Form from 'react-bootstrap/Form'\nimport Toast from 'react-bootstrap/Toast'\n\n\nimport ExtractingAnnotation from '../../processing/annotation-processing'\nimport ChangeTable from '../Components/change_table'\nimport { NavDropdown } from \"react-bootstrap\";\n\n//Custom implemented classes\nimport { BoundingBox } from '../../annotations/bounding_box'\nimport { KeyPoint } from '../../annotations/key_point'\nimport { Segmentation } from '../../annotations/segmentation'\nimport Instructions from \"../Components/instructions\";\n\nimport BootstrapTable from 'react-bootstrap-table-next';\nimport cellEditFactory, { Type } from 'react-bootstrap-table2-editor';\nimport 'react-bootstrap-table-next/dist/react-bootstrap-table2.min.css';\nimport paginationFactory from 'react-bootstrap-table2-paginator';\nimport { CSVExport } from 'react-bootstrap-table2-toolkit';\n\nimport {behaviors} from '../../static_data/behaviors_LPS'\nimport {posture} from '../../static_data/posture'\nimport {status} from '../../static_data/status'\n//import {columns} from '../../static_data/columns' //TODO re-add columns\n\n//TODO add local storage functionality to auto-save\nif (typeof(Storage) === \"undefined\") {\n  // Code for localStorage/sessionStorage.\n  alert('Your browser does not support local storage. \\nSome autosaving features of the app will not work as intended.\\nPlease see the documentation to find supported browsers and their versions')\n}\n\nconst ANNOTATION_FRAME = \"1\"\nconst ANNOTATION_BBOX = \"2\"\nconst ANNOTATION_KEYPOINT = \"3\"\nconst ANNOTATION_SEG = \"4\"\n\nconst fabric = require(\"fabric\").fabric;\nconst createReactClass = require('create-react-class');\n\n\n\n//TODO ADD DYNAMIC SOLUTION \nvar frame_rate = 15;\nvar num_frames = -1;\nvar scaling_factor_width = 1920;\nvar scaling_factor_height = 1080;\nvar skip_value = 1;\n\nconsole.log(window.screen.width)\nconsole.log(window.screen.height)\n\nvar current_screen_width = window.screen.width;\nvar current_screen_height = window.screen.height;\n\n//Mappings are based off of https://en.wikipedia.org/wiki/List_of_common_resolutions make sure to use 1:1 and 16:9 aspect ratio\nif (current_screen_height >= 1440){\n  scaling_factor_width = 1920;\n  scaling_factor_height = 1080;\n}else if(current_screen_height >= 1080){\n  scaling_factor_width = 1280;\n  scaling_factor_height = 720;\n}else if(current_screen_height >= 1024){\n  scaling_factor_width = 1152;\n  scaling_factor_height = 648;\n}else if(current_screen_height >= 768){\n  scaling_factor_width = 1024;\n  scaling_factor_height = 576;\n}\n\n\n// globally accessable fabricCanvas instance\nvar fabricCanvas = new fabric.Canvas('c', {uniScaleTransform: true});\n\nvar video_width = 0;\nvar video_height = 0;\n\nvar frame_data = [[]];\nvar annotation_data = [[]];\nvar upload = false;\nvar disable_buttons = true;\nvar currentFrame = 0;\nvar sliderPercent = 0\nvar toast_text = \"\"\nvar previous_annotation = []\nvar previous_canvas_annotation = []\nvar ANNOTATOR_NAME = \"\"\nvar ANNOTATION_VIDEO_NAME = \"\"\n\n\nfunction save_data(frame_num){\n  frame_data[frame_num] = fabricCanvas.toJSON()\n  console.log(\"SAVED\")\n}\n\n\n//Current frame counter\nfunction MainMultiview() {\n  const columns = [{\n    dataField: \"id\",\n    text: \"ID\",\n    headerStyle: () => { return { width: \"40px\", left: 0 }; }\n  },{\n    dataField: \"global_id\",\n    text: \"Glo\",\n    headerStyle: () => { return { width: \"50px\", left: 0}; },\n    editCellStyle: (cell, row, rowIndex, colIndex) => {\n      const backgroundColor = cell > 2101 ? '#00BFFF' : '#00FFFF';\n      return { backgroundColor };\n    }\n  },{\n    dataField: \"status\",\n    text: \"Status\",\n    editor: {\n        type: Type.SELECT,\n        options: status\n      }\n  },{\n    dataField: \"current\",\n    text: \"Curr\",\n    editor: {\n      type: Type.CHECKBOX,\n      value: 'Start:Stop'\n    },\n    headerStyle: () => { return { width: \"60px\", left: 0}; },\n  },{\n    dataField: \"behavior\",\n    text: \"Behavior\",\n    editor: {\n        type: Type.SELECT,\n        options: behaviors,\n    }\n  },\n  {\n    dataField: \"posture\",\n    text: \"Posture\",\n    editor: {\n        type: Type.SELECT,\n        options: posture,\n    }\n  },{\n    dataField: \"remove\",\n    text: \"Del\",\n    editable: false,\n    headerStyle: () => { return { width: \"50px\", left: 0}; },\n    formatter: (cellContent, row) => {\n      return (\n        <button\n          className=\"btn btn-danger btn-xs\"\n            onClick={() => remove_table_index(row.id)}\n            label=\"Del\"\n          >\n        </button>\n      );\n    },\n  }\n  ]\n  \n  const remove_table_index = (index) => {\n    var index_num = 0;\n\n    for(var i = 0; i < annotation_data[currentFrame].length; i++){\n      if(annotation_data[currentFrame][i]['id'] == index){\n        index_num = i\n        break;\n      }\n    }\n\n    if(index.substring(index.length-1, index.length) !== \"f\"){\n      for(var i = 0; i < fabricCanvas.getObjects().length; i++){\n        if(fabricCanvas.getObjects()[i]['_objects'][1]['text'] === index){\n          fabricCanvas.remove(fabricCanvas.getObjects()[i]);\n          fabricCanvas.fire('saveData');\n          break;\n        }\n      }\n    }\n    console.log(annotation_data[currentFrame])\n    annotation_data[currentFrame].splice(index_num, 1)\n    console.log(annotation_data[currentFrame])\n    save_data(currentFrame)\n    //TODO make this more elegant - Currently makes a random number since the state change using an incremental update to the integer caused a stop of state updates and did not respond to any changes. This forces the values to be changed on random and should not have any dependence of the previous value of the visual toggle state.\n    setVisualToggle(Math.floor(Math.random() * 999999999999))\n  }\n  \n  const [visualToggle, setVisualToggle] = useState(0);\n  \n  console.log(visualToggle)\n\n  const save_previous_data = () => {\n    if(annotation_data[currentFrame].length == 0){\n      return;\n    }\n    console.log(annotation_data[currentFrame].length === 0)\n    console.log(\"saved annotation\")\n    previous_annotation = annotation_data[currentFrame]\n    previous_canvas_annotation = frame_data[currentFrame]\n  }\n\n  const [annotationType, setAnnotationType] = useState(\"1\")\n  const handleAnnotationType = (event) => {\n    console.log(event.target.value)\n  }\n  \n  const [boxCount, setBoxCount] = useState(0)\n  const addToCanvas = () =>{\n    var color = \"#\" + ((1<<24)*Math.random() | 0).toString(16)\n    \n    if(annotation_data[currentFrame] == null){\n      annotation_data[currentFrame] = []\n    }\n    \n    if (annotationType === ANNOTATION_BBOX){\n      annotation_data[currentFrame].push({id: boxCount+'b', global_id: null,status: \"\", current: \"Start\", behavior: \"None\"})\n      var new_bbox = new BoundingBox(fabricCanvas.height/2, fabricCanvas.width/2, 50, 50, color, boxCount+'b', \"None\").generate_no_behavior(fabricCanvas)\n      fabricCanvas.add(new_bbox)\n    }else if (annotationType === ANNOTATION_KEYPOINT){\n      //TODO fix KeyPoint\n      alert(\"KeyPoint annotation are currently unavailable\")\n      //annotation_data[currentFrame].push({id: boxCount+'k', behavior: \"None\", is_hidden: 0, posture: \"None\"})\n      //var keyp = new KeyPoint().generate_stick(fabricCanvas)\n    }else if (annotationType === ANNOTATION_SEG){\n      alert(\"Segmentation annotation is currently under development\")\n      //TODO Fix segmentation issues\n      annotation_data[currentFrame].push({id: boxCount+'s', global_id:null, status: \"None\", current: \"Start\", behavior: \"None\"})\n      var segment = new Segmentation().generate_polygon(fabricCanvas, boxCount+'s')\n    }else if(annotationType === ANNOTATION_FRAME){\n      //TODO Add annotation frame datapoint\n      annotation_data[currentFrame].push({id: boxCount+'f', global_id: null,status: \"\", current: \"Start\", behavior: \"None\"})\n    }\n    save_data(currentFrame)\n    setBoxCount(boxCount + 1);\n    fabricCanvas.fire('saveData');\n  }\n\n  const remove = () => {\n    setBoxCount(boxCount + 1)\n    if(fabricCanvas.getActiveObject() === null){\n      console.log(fabricCanvas.getObjects())\n      alert(\"Please select a bounding box / segmentation from the screen to delete.\")\n      //return\n    }\n    console.log(fabricCanvas.getActiveObject())\n    var index = fabricCanvas.getActiveObject().toJSON()['local_id']\n    for(var i = 0; i < annotation_data[currentFrame].length; i++){\n      if (annotation_data[currentFrame][i]['id'] === index){\n        annotation_data[currentFrame].splice(i, 1)\n        break;\n      }\n    }\n    fabricCanvas.remove(fabricCanvas.getActiveObject());\n    fabricCanvas.fire('saveData');\n  }\n\n  const [videoFilePath, setVideoFileURL] = useState(null);\n  const handleVideoUpload = (event) => {\n    setVideoFileURL(URL.createObjectURL(event.target.files[0]));\n    console.log(event.target.files[0])\n    ANNOTATION_VIDEO_NAME = event.target.files[0]['name']\n    upload = true;\n  };\n\n  //Code for dual video upload option. Currently disabled\n  const [videoFilePath1, setVideoFileURL1] = useState(null);\n  const handleVideoUpload1 = (event) => {\n    setVideoFileURL1(URL.createObjectURL(event.target.files[0]));\n  };\n  \n  //ASYNC Function  - To note that the data that comes out of this will be a bit delayed and this could cause some issues.\n  const [oldAnnotation, setOldAnnotation] = useState(null)\n  const handleOldAnnotation = (event) => {\n      var promise = downloadOldAnnotation(event)\n      promise.then(function (result) {\n        if(result != null){\n          setOldAnnotation(new ExtractingAnnotation(result));\n        }else{\n          console.log(\"ERROR in upload old_annotation\")\n        }\n      })\n  }\n\n  useEffect(() => {\n    //TODO Find a more elegant solution. This is a temporay patch work.\n    if(oldAnnotation == null){\n      return;\n    }\n    alert(\"Annotation upload processed.\\nAny existing annotations will be deleted and replaced with uploaded ones.\")\n    console.log(oldAnnotation)\n    console.log(oldAnnotation.get_frame_data());\n    frame_data = oldAnnotation.get_frame_data();\n    annotation_data = oldAnnotation.get_annotation_data();\n    handle_visual_toggle()\n  }, oldAnnotation);\n\n  const downloadOldAnnotation = (file) => {\n    return new Promise((resolve, reject) => {\n      var reader = new FileReader();\n      reader.onload = function(e) {\n         resolve((JSON.parse(e.target.result)));\n      }\n      reader.readAsText(file.target.files[0])\n    })\n  }\n  \n\n  const [playing, setPlaying] = useState(false);\n  const handlePlaying = (event) => {\n    setPlaying(!playing)\n  }\n\n  var play_button_text = \"ERROR\"\n  if(playing === true){\n    play_button_text = \"Pause\"\n  }else{\n  play_button_text = \"Play\"\n  }\n\n  const [seeking, setSeeking] = useState(false)\n\n\n  const handleSeekChange = e => {\n    sliderPercent = (parseFloat(e.target.value))\n  }\n\n  const handleSeekMouseDown = e => {\n    setSeeking(true)\n  }\n\n  const handleSeekMouseUp = e => {\n    setSeeking(false)\n    player.seekTo(parseFloat(e.target.value))\n  }\n\n  const [player, setPlayer] = useState(null)\n  const handleSetPlayer = val => {\n    //console.log(val)\n    if(val != null){\n      if(val['player'] != null){\n        if(val['player']['player'] != null){\n          if(val['player']['player'] != null){\n            video_width = val['player']['player']['player'].videoWidth\n            video_height = val['player']['player']['player'].videoHeight\n            var duration = val['player']['player']['player'].duration\n            //alert(\"*Loaded player* \\nHorizontal Resolution = \" + video_width + \"\\nVertical Resolution = \" + video_height + \"\\nFrame Rate: \" + frame_rate + \" FPS\\nDuration: \" + duration + \" seconds\")\n          }\n        }\n      }\n    }\n    setPlayer(val)\n  }\n\n  //TODO Autoset resolution\n  \n\n\n  const [duration, setDuration] = useState(0);\n  const handleSetDuration = val => {\n    if(upload === true && player != null){      \n      console.log(\"Initializing...\")\n      num_frames = Math.round(val * frame_rate);\n\n      frame_data = new Array(num_frames)\n      annotation_data = new Array(num_frames)\n\n      //TODO Update this later\n      for (var i = 0; i < num_frames; i++){\n        frame_data[i] = []\n        annotation_data[i] = []\n      }\n      upload = false;\n      disable_buttons = false\n    }\n    setDuration(parseInt(val))\n    console.log(val)\n  }\n\n\n  const handleSetCurrentFrame = val => {\n    save_data(currentFrame)\n    var total_frames = duration * frame_rate\n    currentFrame = (val['played']/total_frames)\n    currentFrame = (Math.round(val['played']*total_frames))\n    handle_visual_toggle()\n    /*if(oldAnnotation != null){ //ANNOTATIONS FOR MCPT (Multi Camera Pig Tracking) additions. TODO add in another class to process all instead of doing per-frame basis which is slow and inefficient.)\n      //fabricCanvas.clear();\n      var bbox = new FrameBoundingBox(oldAnnotation.getAllObjectByFrame(currentFrame), scaling_factor_width, scaling_factor_height).generate_frame()\n      for(var i = 0; i < bbox.length; i++){\n        var curr_obj = bbox[i]\n        console.log(curr_obj)\n        fabricCanvas.add(curr_obj);\n        fabricCanvas.setActiveObject(curr_obj);\n        fabricCanvas.fire('saveData');\n      }\n    }*/\n\n  }\n\n  const [scrubbing, setScrubbing] = useState(true);\n\n  const skip_frame_forward = e =>{\n    save_previous_data()\n    if(scrubbing === false){\n      if (annotation_data[currentFrame+skip_value].length == 0){\n        annotation_data[currentFrame+skip_value] = JSON.parse(JSON.stringify(annotation_data[currentFrame]));\n        frame_data[currentFrame+skip_value] = frame_data[currentFrame];\n        console.log(\"Carryover annotation\")\n      }\n    }\n\n    var total_frames = duration * frame_rate\n    console.log((((player.getCurrentTime()/duration)*total_frames))/(total_frames) + (skip_value/total_frames))\n    player.seekTo((((player.getCurrentTime()/duration)*total_frames))/(total_frames) + (skip_value/total_frames))\n  }\n\n  const skip_frame_backward = e => {\n    save_previous_data()\n    var total_frames = duration * frame_rate\n    player.seekTo((((player.getCurrentTime()/duration)*total_frames))/(total_frames) - (skip_value/total_frames))\n  }\n\n  const downloadFile = async () => {\n    var fileName = \"generated_annotations\";\n    if(ANNOTATION_VIDEO_NAME !== \"\" && ANNOTATOR_NAME !== \"\"){\n      fileName = ANNOTATION_VIDEO_NAME.split('.').slice(0, -1).join('.') + \"_\" +  ANNOTATOR_NAME\n    }\n    //const json = JSON.stringify(fabricCanvas.getObjects());\n    const json = JSON.stringify({\"annotations\": frame_data, \"behavior_data\": annotation_data})\n    //var json = JSON.stringify(frame_data);\n    var blob = new Blob([json],{type:'application/json'});\n    var href = await URL.createObjectURL(blob);\n    var link = document.createElement('a');\n    link.href = href;\n    link.download = fileName + \".json\";\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n\n\n  }\n\n  const [show, setShow] = useState(false);\n\n  const handleClose = () => setShow(false);\n  const handleShow = () => setShow(true);\n\n  const [save, changeSave] = useState(false);\n  \n  const [keyCheck, changeKeyCheck] = useState(true)\n  const handle_key_check = (event) => {\n    changeKeyCheck(!keyCheck)\n    console.log(\"Changing keyCheck to: \" + keyCheck)\n  }\n\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  const onKeyPress = (event) =>{\n    //Making sure input for textbox doesnt get counted as a mode change\n    if(keyCheck == false){\n      return;\n    }\n    //TODO Add keystroke disabling when typing in values in other parts\n\n    if (event.key === ANNOTATION_BBOX){\n      toast_text = \"Mode Switch: Bounding Box\"\n      changeSave(true)\n      setAnnotationType(ANNOTATION_BBOX)\n    }else if (event.key === ANNOTATION_KEYPOINT){\n      toast_text = \"Mode Switch: Key Point\"\n      changeSave(true)\n      setAnnotationType(ANNOTATION_KEYPOINT)\n    }else if(event.key === ANNOTATION_SEG) {\n      toast_text = \"Mode Switch: Segmentation\"\n      changeSave(true)\n      setAnnotationType(ANNOTATION_SEG)\n    }else if(event.key === ANNOTATION_FRAME){\n      toast_text = \"Mode Switch: Behavior Annotation\"\n      changeSave(true)\n      setAnnotationType(ANNOTATION_FRAME)\n    }else if (event.key === \"a\"){\n      var annotext = \"\"\n      if(annotationType === ANNOTATION_BBOX){\n        annotext = \"Bounding Box\"\n      }else if(annotationType === ANNOTATION_FRAME){\n        annotext = \"Behavior Data\"\n      }else if (annotationType === ANNOTATION_KEYPOINT){\n        annotext = \"Keypoint\"\n      }else if (annotationType === ANNOTATION_SEG){\n        annotext = \"Segmentation\"\n      }\n      toast_text = \"Added Annotation - \" + annotext\n      changeSave(true)\n      addToCanvas()\n    }else if (event.key === \"r\"){\n      //TODO Determine if having a remove key is efficient or the deletion can be done directly from UI\n      //toast_text = \"Removed Annotation\"\n      //changeSave(true)\n      //remove()\n    }else if (event.key === \"q\"){\n      skip_frame_backward()\n    }else if (event.key === \"w\"){\n      handlePlaying()\n    }else if (event.key === \"e\"){\n      skip_frame_forward()\n    }else if (event.key === \"s\"){\n      toast_text = \"Annotation Saved\"\n      changeSave(true)\n      frame_data[currentFrame] = fabricCanvas.toJSON()\n    }else if (event.key === \"f\"){\n      if(scrubbing === false){\n        toast_text = \"Scrubbing Mode Activated\"\n        setScrubbing(true)\n        changeSave(true)\n      }else{\n        toast_text = \"Scrubbing Mode Deactivated\"\n        setScrubbing(false)\n        changeSave(true)\n      }\n    }else if(event.key === \"c\"){\n      toast_text = \"Copying previous frame annotation\"\n      annotation_data[currentFrame] = JSON.parse(JSON.stringify(previous_annotation))\n      frame_data[currentFrame] = JSON.parse(JSON.stringify(previous_canvas_annotation))\n      changeSave(true)\n    }\n  }  \n\n  const [test, changeTest] = useState(false);\n \n  useEffect(() => {\n    document.addEventListener(\"keydown\", onKeyPress);\n    return () => document.removeEventListener(\"keydown\", onKeyPress);\n  }, [onKeyPress]);\n  \n  fabricCanvas.loadFromJSON(frame_data[currentFrame], function() {\n    fabricCanvas.renderAll();\n  });\n\n  const handle_link_open = () => {\n    window.open(\"https://forms.gle/CrJuYEoT39uFgnR17\", \"_blank\")\n  }\n\n  /*\n    <NavDropdown disabled={disable_buttons} title=\"Mode\" id=\"basic-nav-dropdown\">\n    <NavDropdown.Item onClick={setAnnotationType(ANNOTATION_BBOX)} >Square Box</NavDropdown.Item>\n    <NavDropdown.Divider />\n    <NavDropdown.Item onClick={setAnnotationType(ANNOTATION_KEYPOINT)}>Key Point</NavDropdown.Item>\n    <NavDropdown.Divider />\n    <NavDropdown.Item onClick={setAnnotationType(ANNOTATION_SEG)}>Segmentation</NavDropdown.Item>\n  </NavDropdown>\n  */ \n  const handle_visual_toggle = () => {\n    setVisualToggle(visualToggle+1)\n  }\n\n  return (\n    <div>\n      <Navbar bg=\"dark\" variant=\"dark\" className=\"bg-5\">\n          <Navbar.Brand href=\"#home\">Annotation Tool</Navbar.Brand>\n          <Nav className=\"mr-auto\">\n              <Nav.Link onClick={handleShow}>Instructions</Nav.Link>\n\n\n\n              <NavDropdown disabled={disable_buttons} title=\"Export\" id=\"basic-nav-dropdown\">\n                <NavDropdown.Item onClick={downloadFile}>JSON</NavDropdown.Item>\n                <NavDropdown.Divider />\n                <NavDropdown.Item >CSV</NavDropdown.Item>\n              </NavDropdown>\n\n              <NavDropdown title=\"Settings\" id=\"basic-nav-dropdown\">\n                <NavDropdown.Divider />\n                Frame Rate: <input type=\"number\" defaultValue=\"15\"></input>\n                <NavDropdown.Divider />\n                Horizontal Res: <input type='number' defaultValue={video_width}></input>\n                <NavDropdown.Divider />\n                Vertical Res: <input type='number' defaultValue={video_height}></input>\n                <NavDropdown.Divider />\n                Skip Value: <input type='number' defaultValue=\"1\" onChange={(event) => {skip_value = parseInt(event.target.value)}}></input>\n                <NavDropdown.Divider />\n                Annotator Name: <input type='text' defaultValue=\"\" onChange={(event) => {ANNOTATOR_NAME = (event.target.value)}}></input>\n              </NavDropdown>\n\n              <Nav.Link onClick={handle_link_open}>Report</Nav.Link>\n          </Nav>\n\n          <div>\n            <Form style={{float: \"left\", width: 80}}>\n              <Form.File disabled={disable_buttons} id=\"file\" label=\"Annotation Upload\" custom type=\"file\" onChange={handleOldAnnotation}/>\n            </Form>\n            <Form style={{float: \"left\", width: 80}}>\n              <Form.File id=\"file\" label=\"Video Upload\" accept=\".mp4\" custom type=\"file\" onChange={handleVideoUpload} />\n            </Form>\n            <Form style={{float: \"left\", width: 80}}>\n              <Form.File id=\"file\" label=\"Video Upload\" accept=\".mp4\" custom type=\"file\" onChange={handleVideoUpload1} />\n            </Form>\n            <Button variant=\"secondary\" disabled={true}>Frame # {parseInt(currentFrame)+' / '+parseInt(duration * frame_rate)}</Button>{' '}\n            <Button variant=\"primary\" disabled={disable_buttons} onClick={skip_frame_backward}>Prev</Button>{' '}\n            <Button variant=\"primary\" disabled={disable_buttons} onClick={handlePlaying}>{play_button_text}</Button>{' '}\n            <Button variant=\"primary\" disabled={disable_buttons} onClick={skip_frame_forward}>Next</Button>{' '}\n            <Button variant=\"success\" disabled={disable_buttons} onClick={addToCanvas} style={{position:\"relative\"}}>Add</Button>{' '}\n            {/*<Button variant=\"danger\" onClick={remove} disabled={disable_buttons} style={{position:\"relative\"}}>Remove</Button>{' '}*/}\n          </div>\n      </Navbar>\n      <Toast onClose={() => changeSave(false)} show={save} delay={500} autohide\n          style={{\n            position: 'absolute',\n            top: 0,\n            left: '40%',\n            zIndex: 100\n          }}>\n        <Toast.Header>\n          <strong className=\"mr-auto\">{toast_text}</strong>\n        </Toast.Header>\n      </Toast>\n      <Modal show={show} onHide={handleClose} size='lg'>\n          <Modal.Header closeButton>\n          <Modal.Title>Instructions</Modal.Title>\n          </Modal.Header>\n          <Modal.Body><Instructions></Instructions></Modal.Body>\n          <Modal.Footer>\n          <Button variant=\"secondary\" onClick={handleClose}>Close</Button>\n          </Modal.Footer>\n      </Modal>\n      <div style={{display: \"grid\"}}>\n        <div style={{gridColumn: 1, gridRow:1, position: \"relative\", height: current_screen_height*.4}}>\n          <ReactPlayer \n            onProgress={handleSetCurrentFrame} \n            ref={handleSetPlayer} \n            onDuration={handleSetDuration} \n            url={videoFilePath} \n            width='100%'\n            height='99.999%'\n            playing={playing} \n            controls={false} \n            volume={0}\n            muted={true}\n            pip={false}\n          />\n        </div>\n        <div style={{gridColumn: 1, gridRow:2, position: \"relative\",height: current_screen_height*.4}}>\n          <ReactPlayer \n            onProgress={handleSetCurrentFrame} \n            ref={handleSetPlayer} \n            onDuration={handleSetDuration} \n            url={videoFilePath1} \n            width='100%'\n            height='99.999%'\n            playing={playing} \n            controls={false} \n            volume={0}\n            muted={true}\n            pip={false}\n          />\n        </div>\n        <div style={{gridColumn: 1, gridRow:3, position: \"relative\", top: 0, left: 0}}>\n          <input\n            style={{width: scaling_factor_width*.5}}\n            type='range' min={0} max={0.999999} step='any'\n            value={sliderPercent}\n            onMouseDown={handleSeekMouseDown}\n            onChange={handleSeekChange}\n            onMouseUp={handleSeekMouseUp}\n          />\n        </div>\n        <div style={{gridColumn: 2, gridRow:1, position: \"relative\",width: current_screen_width*.4, top: 0, left: 0}}>\n          <div>\n            <BootstrapTable\n              keyField='id'\n              data={annotation_data[currentFrame]} \n              columns={ columns }\n              table\n              noDataIndication={ () => <div>No recorded annotations or behaviors for this frame<br/>Please add an annotation or behavior tag to start.</div> }\n              cellEdit={\n                cellEditFactory({ mode: 'click', blurToSave: true,\n                  afterSaveCell: (oldValue, newValue, row, column) => {\n                    //console.log(annotation_data[currentFrame][row['id']])\n                    annotation_data[currentFrame][row['id']] = row\n                    changeKeyCheck(true)\n                  },\n                  onStartEdit: (row, column, rowIndex, columnIndex) => {\n                    changeKeyCheck(false)\n                  }\n                }) \n              }\n              pagination={ paginationFactory() }\n            />\n            </div>\n        </div>\n        \n      </div>\n    </div>\n  );\n}\n\n\nexport default MainMultiview;","\nimport React, { useState } from \"react\"; \nimport ReactDOM from 'react-dom'\nimport ReactPlayer from 'react-player'\nimport 'bootstrap/dist/css/bootstrap.min.css';\n\nimport Button from 'react-bootstrap/Button'\nimport Navbar from 'react-bootstrap/Navbar'\nimport Nav from 'react-bootstrap/Nav'\nimport Modal from 'react-bootstrap/Modal'\nimport Form from 'react-bootstrap/Form'\nimport Table from 'react-bootstrap/Table'\n\nimport MainUpload from './main_upload'\nimport MainYoutube from './main_youtube'\nimport MainMultiview from './main_muiltiview'\nimport { Container, Jumbotron } from \"react-bootstrap\";\n\n//<img src={process.env.PUBLIC_URL + '/favicon.ico'} alt=\"logo\" style={{width: \"30%\"}} />\nfunction SelectionScreen(){\n    const [] = useState(false)\n\n    const [youtube, setYoutube] = useState(false)\n    const handleYouTube = (event) => {\n        setYoutube(!youtube)\n    } \n\n    const [upload, setUpload] = useState(false)\n    const handleUpload = (event) => {\n        setUpload(!upload)\n    }\n\n    const [multiview, setMultiview] = useState(false)\n    const handleMultiview = (event) => {\n        setMultiview(!multiview)\n    }\n\n    if(youtube){\n        return (<MainYoutube/>)\n    }else if(upload){\n        return (<MainUpload/>)\n    }else if(multiview){\n        return (<MainMultiview/>)\n    }else{\n        return (\n            <Jumbotron fluid>\n                <Container>\n                    <div class=\"row align-items-center\">\n                        <div class=\"pb-4 col-md-6 col-lg-7\">\n                            <h0 style={{fontSize: \"50px\"}}>\n                                Annotation Tool {\"  \"}\n                                <img class=\"\" src={process.env.PUBLIC_URL + '/favicon.ico'} alt=\"logo\" style={{width: \"9%\"}}/>\n                            </h0>\n                            <h5 > Online tool to mass annotate videos for AI/ML </h5>\n                            <Button size=\"lg\">Instructions</Button>\n                        </div> \n\n                        <div class=\"col-md-6 col-lg-5\">\n                            <div class=\"row\">\n                                <div class=\"col\">\n                                    <div class=\"card my-2\">\n                                        <Button onClick={handleUpload} variant=\"outline-success\">Video Upload</Button>\n                                    </div> \n                                </div>\n                                <div class=\"col-12\">\n                                    <div class=\"card my-2\">\n                                        <Button onClick={handleYouTube} variant=\"outline-success\">YouTube</Button>\n                                    </div> \n                                </div>\n                                <div class=\"col-12\">\n                                    <div class=\"card my-2\">\n                                        <Button onClick={handleMultiview} variant=\"outline-success\">Multiview</Button>\n                                    </div> \n                                </div>\n                            </div>\n                        </div> \n                    </div> \n                </Container>\n\n\n                <div class=\"container\">\n                    <div class=\"row align-items-center\">\n                        \n                    </div>\n                </div>\n            </Jumbotron>\n\n        )\n    }\n}\n\nexport default SelectionScreen;","/**\n * @author Pradeep Senthil (pradeepsen99@gmail.com)\n * @\n */\n\n import React, { useState } from \"react\"; \n import ReactDOM from 'react-dom'\n import './App.css';\n import ReactPlayer from 'react-player'\n import 'bootstrap/dist/css/bootstrap.min.css';\n \n import FrontEnd from './ui_elements/Pages/main_upload'\n import SelectionScreen from './ui_elements/Pages/selection_screen'\n \n //<FrontEnd></FrontEnd>\n function App() {\n   return (\n     <div>\n       <SelectionScreen></SelectionScreen>    \n     </div>\n   );\n }\n       //<ActiveObject />\n       //<input type=\"file\" onChange={handleVideoUpload1} />\n       //<div>\n         //<ReactPlayer url={videoFilePath1} width=\"50%\" height=\"50%\" controls={true} style={{position:'relative', float:'left'}}/>\n         //<Fabric/>\n       //</div>\n \n export default App;","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nimport MainUpload from './ui_elements/Pages/main_upload'\nimport MainYoutube from './ui_elements/Pages/main_youtube'\n\nReactDOM.render(\n    <App/>,\n    document.getElementById('root')\n);\n\n/**\n * IF NEED TO RE-ENABLE STRICT MODE THEN UNNCOMMENT AND ADD BACK\n * \n *   <React.StrictMode>\n    <MainUpload></MainUpload>\n  </React.StrictMode>,\n */\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}